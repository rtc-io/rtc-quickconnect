!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.quickconnect=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var base64=_dereq_("base64-js");var ieee754=_dereq_("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=Buffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;Buffer._useTypedArrays=function(){if(typeof Uint8Array!=="function"||typeof ArrayBuffer!=="function")return false;try{var arr=new Uint8Array(0);arr.foo=function(){return 42};return 42===arr.foo()&&typeof arr.subarray==="function"}catch(e){return false}}();function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;if(encoding==="base64"&&type==="string"){subject=stringtrim(subject);while(subject.length%4!==0){subject=subject+"="}}var length;if(type==="number")length=coerce(subject);else if(type==="string")length=Buffer.byteLength(subject,encoding);else if(type==="object")length=coerce(subject.length);else throw new Error("First argument needs to be a number, array or string.");var buf;if(Buffer._useTypedArrays){buf=augment(new Uint8Array(length))}else{buf=this;buf.length=length;buf._isBuffer=true}var i;if(Buffer._useTypedArrays&&typeof Uint8Array==="function"&&subject instanceof Uint8Array){buf._set(subject)}else if(isArrayish(subject)){for(i=0;i<length;i++){if(Buffer.isBuffer(subject))buf[i]=subject.readUInt8(i);else buf[i]=subject[i]}}else if(type==="string"){buf.write(subject,0,encoding)}else if(type==="number"&&!Buffer._useTypedArrays&&!noZero){for(i=0;i<length;i++){buf[i]=0}}return buf}Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.isBuffer=function(b){return!!(b!==null&&b!==undefined&&b._isBuffer)};Buffer.byteLength=function(str,encoding){var ret;str=str+"";switch(encoding||"utf8"){case"hex":ret=str.length/2;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"ascii":case"binary":case"raw":ret=str.length;break;case"base64":ret=base64ToBytes(str).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=str.length*2;break;default:throw new Error("Unknown encoding")}return ret};Buffer.concat=function(list,totalLength){assert(isArray(list),"Usage: Buffer.concat(list, [totalLength])\n"+"list should be an Array.");if(list.length===0){return new Buffer(0)}else if(list.length===1){return list[0]}var i;if(typeof totalLength!=="number"){totalLength=0;for(i=0;i<list.length;i++){totalLength+=list[i].length}}var buf=new Buffer(totalLength);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function _hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;assert(strLen%2===0,"Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);assert(!isNaN(byte),"Invalid hex string");buf[offset+i]=byte}Buffer._charsWritten=i*2;return i}function _utf8Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function _asciiWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function _binaryWrite(buf,string,offset,length){return _asciiWrite(buf,string,offset,length)}function _base64Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function _utf16leWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=Number(offset)||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=_hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=_utf8Write(this,string,offset,length);break;case"ascii":ret=_asciiWrite(this,string,offset,length);break;case"binary":ret=_binaryWrite(this,string,offset,length);break;case"base64":ret=_base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leWrite(this,string,offset,length);break;default:throw new Error("Unknown encoding")}return ret};Buffer.prototype.toString=function(encoding,start,end){var self=this;encoding=String(encoding||"utf8").toLowerCase();start=Number(start)||0;end=end!==undefined?Number(end):end=self.length;if(end===start)return"";var ret;switch(encoding){case"hex":ret=_hexSlice(self,start,end);break;case"utf8":case"utf-8":ret=_utf8Slice(self,start,end);break;case"ascii":ret=_asciiSlice(self,start,end);break;case"binary":ret=_binarySlice(self,start,end);break;case"base64":ret=_base64Slice(self,start,end);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leSlice(self,start,end);break;default:throw new Error("Unknown encoding")}return ret};Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(!start)start=0;if(!end&&end!==0)end=this.length;if(!target_start)target_start=0;if(end===start)return;if(target.length===0||source.length===0)return;assert(end>=start,"sourceEnd < sourceStart");assert(target_start>=0&&target_start<target.length,"targetStart out of bounds");assert(start>=0&&start<source.length,"sourceStart out of bounds");assert(end>=0&&end<=source.length,"sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-target_start<end-start)end=target.length-target_start+start;for(var i=0;i<end-start;i++)target[i+target_start]=this[i+start]};function _base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function _utf8Slice(buf,start,end){var res="";var tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){if(buf[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]);tmp=""}else{tmp+="%"+buf[i].toString(16)}}return res+decodeUtf8Char(tmp)}function _asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);return ret}function _binarySlice(buf,start,end){return _asciiSlice(buf,start,end)}function _hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(buf[i])}return out}function _utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function(start,end){var len=this.length;start=clamp(start,len,0);end=clamp(end,len,len);if(Buffer._useTypedArrays){return augment(this.subarray(start,end))}else{var sliceLen=end-start;var newBuf=new Buffer(sliceLen,undefined,true);for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}return newBuf}};Buffer.prototype.get=function(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};Buffer.prototype.readUInt8=function(offset,noAssert){if(!noAssert){assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;return this[offset]};function _readUInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){val=buf[offset];if(offset+1<len)val|=buf[offset+1]<<8}else{val=buf[offset]<<8;if(offset+1<len)val|=buf[offset+1]}return val}Buffer.prototype.readUInt16LE=function(offset,noAssert){return _readUInt16(this,offset,true,noAssert)};Buffer.prototype.readUInt16BE=function(offset,noAssert){return _readUInt16(this,offset,false,noAssert)};function _readUInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){if(offset+2<len)val=buf[offset+2]<<16;if(offset+1<len)val|=buf[offset+1]<<8;val|=buf[offset];if(offset+3<len)val=val+(buf[offset+3]<<24>>>0)}else{if(offset+1<len)val=buf[offset+1]<<16;if(offset+2<len)val|=buf[offset+2]<<8;if(offset+3<len)val|=buf[offset+3];val=val+(buf[offset]<<24>>>0)}return val}Buffer.prototype.readUInt32LE=function(offset,noAssert){return _readUInt32(this,offset,true,noAssert)};Buffer.prototype.readUInt32BE=function(offset,noAssert){return _readUInt32(this,offset,false,noAssert)};Buffer.prototype.readInt8=function(offset,noAssert){if(!noAssert){assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;var neg=this[offset]&128;if(neg)return(255-this[offset]+1)*-1;else return this[offset]};function _readInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt16(buf,offset,littleEndian,true);var neg=val&32768;if(neg)return(65535-val+1)*-1;else return val}Buffer.prototype.readInt16LE=function(offset,noAssert){return _readInt16(this,offset,true,noAssert)};Buffer.prototype.readInt16BE=function(offset,noAssert){return _readInt16(this,offset,false,noAssert)};function _readInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt32(buf,offset,littleEndian,true);var neg=val&2147483648;if(neg)return(4294967295-val+1)*-1;else return val}Buffer.prototype.readInt32LE=function(offset,noAssert){return _readInt32(this,offset,true,noAssert)};Buffer.prototype.readInt32BE=function(offset,noAssert){return _readInt32(this,offset,false,noAssert)};function _readFloat(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+3<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,23,4)}Buffer.prototype.readFloatLE=function(offset,noAssert){return _readFloat(this,offset,true,noAssert)};Buffer.prototype.readFloatBE=function(offset,noAssert){return _readFloat(this,offset,false,noAssert)};function _readDouble(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+7<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,52,8)}Buffer.prototype.readDoubleLE=function(offset,noAssert){return _readDouble(this,offset,true,noAssert)};Buffer.prototype.readDoubleBE=function(offset,noAssert){return _readDouble(this,offset,false,noAssert)};Buffer.prototype.writeUInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"trying to write beyond buffer length");verifuint(value,255)}if(offset>=this.length)return;this[offset]=value};function _writeUInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"trying to write beyond buffer length");verifuint(value,65535)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,2);i<j;i++){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){_writeUInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){_writeUInt16(this,value,offset,false,noAssert)};function _writeUInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"trying to write beyond buffer length");verifuint(value,4294967295)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,4);i<j;i++){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){_writeUInt32(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){_writeUInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to write beyond buffer length");verifsint(value,127,-128)}if(offset>=this.length)return;if(value>=0)this.writeUInt8(value,offset,noAssert);else this.writeUInt8(255+value+1,offset,noAssert)};function _writeInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to write beyond buffer length");verifsint(value,32767,-32768)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt16(buf,value,offset,littleEndian,noAssert);else _writeUInt16(buf,65535+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt16LE=function(value,offset,noAssert){_writeInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){_writeInt16(this,value,offset,false,noAssert)};function _writeInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifsint(value,2147483647,-2147483648)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt32(buf,value,offset,littleEndian,noAssert);else _writeUInt32(buf,4294967295+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt32LE=function(value,offset,noAssert){_writeInt32(this,value,offset,true,noAssert)};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){_writeInt32(this,value,offset,false,noAssert)};function _writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,23,4)}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){_writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){_writeFloat(this,value,offset,false,noAssert)};function _writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+7<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,52,8)}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){_writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){_writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.fill=function(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(typeof value==="string"){value=value.charCodeAt(0)}assert(typeof value==="number"&&!isNaN(value),"value is not a number");assert(end>=start,"end < start");if(end===start)return;if(this.length===0)return;assert(start>=0&&start<this.length,"start out of bounds");assert(end>=0&&end<=this.length,"end out of bounds");for(var i=start;i<end;i++){this[i]=value}};Buffer.prototype.inspect=function(){var out=[];var len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this[i]);if(i===exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<Buffer "+out.join(" ")+">"};Buffer.prototype.toArrayBuffer=function(){if(typeof Uint8Array==="function"){if(Buffer._useTypedArrays){return new Buffer(this).buffer}else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1)buf[i]=this[i];return buf.buffer}}else{throw new Error("Buffer.toArrayBuffer not supported in this browser")}};function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}var BP=Buffer.prototype;function augment(arr){arr._isBuffer=true;arr._get=arr.get;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=BP.readUInt32BE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr}function clamp(index,len,defaultValue){if(typeof index!=="number")return defaultValue;index=~~index;if(index>=len)return len;if(index>=0)return index;index+=len;if(index>=0)return index;return 0}function coerce(length){length=~~Math.ceil(+length);return length<0?0:length}function isArray(subject){return(Array.isArray||function(subject){return Object.prototype.toString.call(subject)==="[object Array]"})(subject)}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){var b=str.charCodeAt(i);if(b<=127)byteArray.push(str.charCodeAt(i));else{var start=i;if(b>=55296&&b<=57343)i++;var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%");for(var j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){var pos;for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}function verifuint(value,max){assert(typeof value==="number","cannot write a non-number as a number");assert(value>=0,"specified a negative value for writing an unsigned value");assert(value<=max,"value is larger than maximum value for type");assert(Math.floor(value)===value,"value has a fractional component")}function verifsint(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value");assert(Math.floor(value)===value,"value has a fractional component")}function verifIEEE754(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value")}function assert(test,message){if(!test)throw new Error(message||"Failed assertion")}},{"base64-js":2,ieee754:3}],2:[function(_dereq_,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){"use strict";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var ZERO="0".charCodeAt(0);var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS)return 62;if(code===SLASH)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}module.exports.toByteArray=b64ToByteArray;module.exports.fromByteArray=uint8ToBase64})()},{}],3:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],4:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{throw TypeError('Uncaught, unspecified "error" event.')}return false}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);console.trace()}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],5:[function(_dereq_,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],6:[function(_dereq_,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;
var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^ -~]/,regexSeparators=/\x2E|\u3002|\uFF0E|\uFF61/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw RangeError(errors[type])}function map(array,fn){var length=array.length;while(length--){array[length]=fn(array[length])}return array}function mapDomain(string,fn){return map(string.split(regexSeparators),fn).join(".")}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(domain){return mapDomain(domain,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(domain){return mapDomain(domain,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={version:"1.2.4",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return punycode})}else if(freeExports&&!freeExports.nodeType){if(freeModule){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],7:[function(_dereq_,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],8:[function(_dereq_,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return obj[k].map(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],9:[function(_dereq_,module,exports){"use strict";exports.decode=exports.parse=_dereq_("./decode");exports.encode=exports.stringify=_dereq_("./encode")},{"./decode":7,"./encode":8}],10:[function(_dereq_,module,exports){(function(){"use strict";var punycode=_dereq_("punycode");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,delims=["<",">",'"',"`"," ","\r","\n","	"],unwise=["{","}","|","\\","^","~","`"].concat(delims),autoEscape=["'"].concat(delims),nonHostChars=["%","/","?",";","#"].concat(unwise).concat(autoEscape),nonAuthChars=["/","@","?","#"].concat(delims),hostnameMaxLen=255,hostnamePartPattern=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,hostnamePartStart=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},pathedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"ftp:":true,"gopher:":true,"file:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=_dereq_("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&typeof url==="object"&&url.href)return url;if(typeof url!=="string"){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var out={},rest=url;rest=rest.trim();var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();out.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);out.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var atSign=rest.indexOf("@");if(atSign!==-1){var auth=rest.slice(0,atSign);var hasAuth=true;for(var i=0,l=nonAuthChars.length;i<l;i++){if(auth.indexOf(nonAuthChars[i])!==-1){hasAuth=false;break}}if(hasAuth){out.auth=decodeURIComponent(auth);rest=rest.substr(atSign+1)}}var firstNonHost=-1;for(var i=0,l=nonHostChars.length;i<l;i++){var index=rest.indexOf(nonHostChars[i]);if(index!==-1&&(firstNonHost<0||index<firstNonHost))firstNonHost=index}if(firstNonHost!==-1){out.host=rest.substr(0,firstNonHost);rest=rest.substr(firstNonHost)}else{out.host=rest;rest=""}var p=parseHost(out.host);var keys=Object.keys(p);for(var i=0,l=keys.length;i<l;i++){var key=keys[i];out[key]=p[key]}out.hostname=out.hostname||"";var ipv6Hostname=out.hostname[0]==="["&&out.hostname[out.hostname.length-1]==="]";if(out.hostname.length>hostnameMaxLen){out.hostname=""}else if(!ipv6Hostname){var hostparts=out.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}out.hostname=validParts.join(".");break}}}}out.hostname=out.hostname.toLowerCase();if(!ipv6Hostname){var domainArray=out.hostname.split(".");var newOut=[];for(var i=0;i<domainArray.length;++i){var s=domainArray[i];newOut.push(s.match(/[^A-Za-z0-9_-]/)?"xn--"+punycode.encode(s):s)}out.hostname=newOut.join(".")}out.host=(out.hostname||"")+(out.port?":"+out.port:"");out.href+=out.host;if(ipv6Hostname){out.hostname=out.hostname.substr(1,out.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){out.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){out.search=rest.substr(qm);out.query=rest.substr(qm+1);if(parseQueryString){out.query=querystring.parse(out.query)}rest=rest.slice(0,qm)}else if(parseQueryString){out.search="";out.query={}}if(rest)out.pathname=rest;if(slashedProtocol[proto]&&out.hostname&&!out.pathname){out.pathname="/"}if(out.pathname||out.search){out.path=(out.pathname?out.pathname:"")+(out.search?out.search:"")}out.href=urlFormat(out);return out}function urlFormat(obj){if(typeof obj==="string")obj=urlParse(obj);var auth=obj.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=obj.protocol||"",pathname=obj.pathname||"",hash=obj.hash||"",host=false,query="";if(obj.host!==undefined){host=auth+obj.host}else if(obj.hostname!==undefined){host=auth+(obj.hostname.indexOf(":")===-1?obj.hostname:"["+obj.hostname+"]");if(obj.port){host+=":"+obj.port}}if(obj.query&&typeof obj.query==="object"&&Object.keys(obj.query).length){query=querystring.stringify(obj.query)}var search=obj.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(obj.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;return protocol+host+pathname+search+hash}function urlResolve(source,relative){return urlFormat(urlResolveObject(source,relative))}function urlResolveObject(source,relative){if(!source)return relative;source=urlParse(urlFormat(source),false,true);relative=urlParse(urlFormat(relative),false,true);source.hash=relative.hash;if(relative.href===""){source.href=urlFormat(source);return source}if(relative.slashes&&!relative.protocol){relative.protocol=source.protocol;if(slashedProtocol[relative.protocol]&&relative.hostname&&!relative.pathname){relative.path=relative.pathname="/"}relative.href=urlFormat(relative);return relative}if(relative.protocol&&relative.protocol!==source.protocol){if(!slashedProtocol[relative.protocol]){relative.href=urlFormat(relative);return relative}source.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");relative.pathname=relPath.join("/")}source.pathname=relative.pathname;source.search=relative.search;source.query=relative.query;source.host=relative.host||"";source.auth=relative.auth;source.hostname=relative.hostname||relative.host;source.port=relative.port;if(source.pathname!==undefined||source.search!==undefined){source.path=(source.pathname?source.pathname:"")+(source.search?source.search:"")}source.slashes=source.slashes||relative.slashes;source.href=urlFormat(source);return source}var isSourceAbs=source.pathname&&source.pathname.charAt(0)==="/",isRelAbs=relative.host!==undefined||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||source.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=source.pathname&&source.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=source.protocol&&!slashedProtocol[source.protocol];if(psychotic){delete source.hostname;delete source.port;if(source.host){if(srcPath[0]==="")srcPath[0]=source.host;else srcPath.unshift(source.host)}delete source.host;if(relative.protocol){delete relative.hostname;delete relative.port;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}delete relative.host}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){source.host=relative.host||relative.host===""?relative.host:source.host;source.hostname=relative.hostname||relative.hostname===""?relative.hostname:source.hostname;source.search=relative.search;source.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);source.search=relative.search;source.query=relative.query}else if("search"in relative){if(psychotic){source.hostname=source.host=srcPath.shift();var authInHost=source.host&&source.host.indexOf("@")>0?source.host.split("@"):false;if(authInHost){source.auth=authInHost.shift();source.host=source.hostname=authInHost.shift()}}source.search=relative.search;source.query=relative.query;if(source.pathname!==undefined||source.search!==undefined){source.path=(source.pathname?source.pathname:"")+(source.search?source.search:"")}source.href=urlFormat(source);return source}if(!srcPath.length){delete source.pathname;if(!source.search){source.path="/"+source.search}else{delete source.path}source.href=urlFormat(source);return source}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(source.host||relative.host)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last=="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){source.hostname=source.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=source.host&&source.host.indexOf("@")>0?source.host.split("@"):false;if(authInHost){source.auth=authInHost.shift();source.host=source.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||source.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}source.pathname=srcPath.join("/");if(source.pathname!==undefined||source.search!==undefined){source.path=(source.pathname?source.pathname:"")+(source.search?source.search:"")}source.auth=relative.auth||source.auth;source.slashes=source.slashes||relative.slashes;source.href=urlFormat(source);return source}function parseHost(host){var out={};var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){out.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)out.hostname=host;return out}})()},{punycode:6,querystring:9}],11:[function(_dereq_,module,exports){"use strict";var EventEmitter=_dereq_("events").EventEmitter;var rtc=_dereq_("rtc");var debug=rtc.logger("rtc-quickconnect");var signaller=_dereq_("rtc-signaller");var defaults=_dereq_("cog/defaults");var extend=_dereq_("cog/extend");var reTrailingSlash=/\/$/;var CHANNEL_HEARTBEAT="__heartbeat";var HEARTBEAT=new Uint8Array([16]);module.exports=function(signalhost,opts){var hash=typeof location!="undefined"&&location.hash.slice(1);var signaller=_dereq_("rtc-signaller")(signalhost,opts);var ns=(opts||{}).ns||"";var room=(opts||{}).room;var debugging=(opts||{}).debug;var disableHeartbeat=(opts||{}).disableHeartbeat;var heartbeatInterval=(opts||{}).heartbeatInterval||1e3;var heartbeatTimeout=(opts||{}).heartbeatTimeout||heartbeatInterval*3;var profile={};var announced=false;var localStreams=[];var peers={};var channels={};function gotPeerChannel(channel,pc,data){var emitChannelOpen=signaller.emit.bind(signaller,channel.label+":open",channel,data.id,data,pc);debug("channel "+channel.label+" discovered for peer: "+data.id,channel);if(channel.readyState==="open"){return emitChannelOpen()}channel.onopen=emitChannelOpen}function initHeartbeat(channel,pc,data){var hbTimeoutTimer;var hbTimer;function timeoutConnection(){signaller.emit("peer:disconnect",data.id);Object.keys(channels).forEach(function(channel){signaller.emit(channel+":close")});peers[data.id]=undefined;clearInterval(hbTimer)}channel.onmessage=function(evt){clearTimeout(hbTimeoutTimer);hbTimeoutTimer=setTimeout(timeoutConnection,heartbeatTimeout);signaller.emit("hb:"+data.id)};hbTimer=setInterval(function(){if(channel.readyState!=="open"){return}channel.send(HEARTBEAT)},heartbeatInterval)}if(!room){if(!hash){hash=location.hash=""+Math.pow(2,53)*Math.random()}room=ns+"#"+hash}if(debugging){rtc.logger.enable.apply(rtc.logger,Array.isArray(debug)?debugging:["*"])}signaller.on("peer:announce",function(data){var pc;var monitor;if(data.room!==room){return}pc=peers[data.id]=rtc.createConnection(opts,(opts||{}).constraints);localStreams.forEach(function(stream){pc.addStream(stream)});if(signaller.isMaster(data.id)){debug("is master, creating data channels: ",Object.keys(channels));if(!disableHeartbeat){initHeartbeat(pc.createDataChannel(CHANNEL_HEARTBEAT,{ordered:false}),pc,data)}Object.keys(channels).forEach(function(label){gotPeerChannel(pc.createDataChannel(label,channels[label]),pc,data)})}else{pc.ondatachannel=function(evt){var channel=evt&&evt.channel;if(!channel){return}if(channel.label===CHANNEL_HEARTBEAT){initHeartbeat(channel,pc,data)}else if(channels[channel.label]!==undefined){gotPeerChannel(channel,pc,data)}}}monitor=rtc.couple(pc,data.id,signaller,opts);signaller.emit("peer",pc,data.id,data,monitor);monitor.once("connected",function(){signaller.emit("peer:connect",pc,data.id,data)});if(signaller.isMaster(data.id)){monitor.createOffer()}});setTimeout(function(){var data=extend({},profile,{room:room});signaller.announce(data);signaller.emit("local:announce",data);announced=true},0);signaller.broadcast=function(stream){localStreams.push(stream);return signaller};signaller.close=function(){Object.keys(peers).forEach(function(id){if(peers[id]){peers[id].close()}});peers={}};signaller.createDataChannel=function(label,opts){channels[label]=opts||null;return signaller};signaller.profile=function(data){extend(profile,data);if(announced){signaller.announce(profile)}return signaller};return signaller}},{"cog/defaults":13,"cog/extend":14,events:4,rtc:48,"rtc-signaller":22}],12:[function(_dereq_,module,exports){(function(process){(function(){var async={};var root,previous_async;root=this;if(root!=null){previous_async=root.async}async.noConflict=function(){root.async=previous_async;return async};function only_once(fn){var called=false;return function(){if(called)throw new Error("Callback was already called.");called=true;fn.apply(root,arguments)}}var _each=function(arr,iterator){if(arr.forEach){return arr.forEach(iterator)}for(var i=0;i<arr.length;i+=1){iterator(arr[i],i,arr)}};var _map=function(arr,iterator){if(arr.map){return arr.map(iterator)}var results=[];_each(arr,function(x,i,a){results.push(iterator(x,i,a))});return results};var _reduce=function(arr,iterator,memo){if(arr.reduce){return arr.reduce(iterator,memo)}_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)});return memo};var _keys=function(obj){if(Object.keys){return Object.keys(obj)}var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}return keys};if(typeof process==="undefined"||!process.nextTick){if(typeof setImmediate==="function"){async.nextTick=function(fn){setImmediate(fn)};async.setImmediate=async.nextTick}else{async.nextTick=function(fn){setTimeout(fn,0)};async.setImmediate=async.nextTick}}else{async.nextTick=process.nextTick;if(typeof setImmediate!=="undefined"){async.setImmediate=function(fn){setImmediate(fn)}}else{async.setImmediate=async.nextTick}}async.each=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}}}))})};async.forEach=async.each;async.eachSeries=function(arr,iterator,callback){callback=callback||function(){};if(!arr.length){return callback()}var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;if(completed>=arr.length){callback(null)}else{iterate()}}})};iterate()};async.forEachSeries=async.eachSeries;async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])};async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){callback=callback||function(){};if(!arr.length||limit<=0){return callback()}var completed=0;var started=0;var running=0;(function replenish(){if(completed>=arr.length){return callback()}while(running<limit&&started<arr.length){started+=1;running+=1;iterator(arr[started-1],function(err){if(err){callback(err);callback=function(){}}else{completed+=1;running-=1;if(completed>=arr.length){callback()}else{replenish()}}})}})()}};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}};var doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}};var doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}};var _asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v;callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap);async.mapSeries=doSeries(_asyncMap);async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};async.inject=async.reduce;async.foldl=async.reduce;async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)};async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter);async.filterSeries=doSeries(_filter);async.select=async.filter;async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(!v){results.push(x)}callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject);async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){if(result){main_callback(x);main_callback=function(){}}else{callback()}})},function(err){main_callback()})};async.detect=doParallel(_detect);async.detectSeries=doSeries(_detect);async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(v){main_callback(true);main_callback=function(){}}callback()})},function(err){main_callback(false)})};async.any=async.some;async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){if(!v){main_callback(false);main_callback=function(){}}callback()})},function(err){main_callback(true)})};async.all=async.every;async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){if(err){callback(err)}else{callback(null,{value:x,criteria:criteria})}})},function(err,results){if(err){return callback(err)}else{var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))}})};async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length){return callback(null)}var results={};var listeners=[];var addListener=function(fn){listeners.unshift(fn)};var removeListener=function(fn){for(var i=0;i<listeners.length;i+=1){if(listeners[i]===fn){listeners.splice(i,1);return}}};var taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(_keys(results).length===keys.length){callback(null,results);callback=function(){}}});_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k];var taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}if(err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]});safeResults[k]=args;callback(err,safeResults);callback=function(){}}else{results[k]=args;async.setImmediate(taskComplete)}};var requires=task.slice(0,Math.abs(task.length-1))||[];var ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},true)&&!results.hasOwnProperty(k)};if(ready()){task[task.length-1](taskCallback,results)}else{var listener=function(){if(ready()){removeListener(listener);task[task.length-1](taskCallback,results)}};addListener(listener)}})};async.waterfall=function(tasks,callback){callback=callback||function(){};if(tasks.constructor!==Array){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}if(!tasks.length){return callback()}var wrapIterator=function(iterator){return function(err){if(err){callback.apply(null,arguments);callback=function(){}}else{var args=Array.prototype.slice.call(arguments,1);var next=iterator.next();if(next){args.push(wrapIterator(next))}else{args.push(callback)}async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){eachfn.map(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)};async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)};async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.mapSeries(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}callback.call(null,err,args)})}},callback)}else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){if(tasks.length){tasks[index].apply(null,arguments)}return fn.next()};fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null};return fn};return makeCallback(0)};async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]);cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat);async.concatSeries=doSeries(_concat);async.whilst=function(test,iterator,callback){if(test()){iterator(function(err){if(err){return callback(err)}async.whilst(test,iterator,callback)})}else{callback()}};async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(test()){async.doWhilst(iterator,test,callback)}else{callback()}})};async.until=function(test,iterator,callback){if(!test()){iterator(function(err){if(err){return callback(err)}async.until(test,iterator,callback)})}else{callback()}};async.doUntil=function(iterator,test,callback){iterator(function(err){if(err){return callback(err)}if(!test()){async.doUntil(iterator,test,callback)}else{callback()}})};async.queue=function(worker,concurrency){if(concurrency===undefined){concurrency=1}function _insert(q,data,pos,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){var item={data:task,callback:typeof callback==="function"?callback:null};if(pos){q.tasks.unshift(item)}else{q.tasks.push(item)}if(q.saturated&&q.tasks.length===concurrency){q.saturated()}async.setImmediate(q.process)})}var workers=0;var q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,false,callback)
},unshift:function(data,callback){_insert(q,data,true,callback)},process:function(){if(workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();if(q.empty&&q.tasks.length===0){q.empty()}workers+=1;var next=function(){workers-=1;if(task.callback){task.callback.apply(task,arguments)}if(q.drain&&q.tasks.length+workers===0){q.drain()}q.process()};var cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers}};return q};async.cargo=function(worker,payload){var working=false,tasks=[];var cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){if(data.constructor!==Array){data=[data]}_each(data,function(task){tasks.push({data:task,callback:typeof callback==="function"?callback:null});if(cargo.saturated&&tasks.length===payload){cargo.saturated()}});async.setImmediate(cargo.process)},process:function process(){if(working)return;if(tasks.length===0){if(cargo.drain)cargo.drain();return}var ts=typeof payload==="number"?tasks.splice(0,payload):tasks.splice(0);var ds=_map(ts,function(task){return task.data});if(cargo.empty)cargo.empty();working=true;worker(ds,function(){working=false;var args=arguments;_each(ts,function(data){if(data.callback){data.callback.apply(null,args)}});process()})},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(err){if(console.error){console.error(err)}}else if(console[name]){_each(args,function(x){console[name](x)})}}}]))}};async.log=_console_fn("log");async.dir=_console_fn("dir");async.memoize=function(fn,hasher){var memo={};var queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments);var callback=args.pop();var key=hasher.apply(null,args);if(key in memo){callback.apply(null,memo[key])}else if(key in queues){queues[key].push(callback)}else{queues[key]=[callback];fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;i<l;i++){q[i].apply(null,arguments)}}]))}};memoized.memo=memo;memoized.unmemoized=fn;return memoized};async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}};async.times=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.map(counter,iterator,callback)};async.timesSeries=function(count,iterator,callback){var counter=[];for(var i=0;i<count;i++){counter.push(i)}return async.mapSeries(counter,iterator,callback)};async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0];var nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}};var _applyEach=function(eachfn,fns){var go=function(){var that=this;var args=Array.prototype.slice.call(arguments);var callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}else{return go}};async.applyEach=doParallel(_applyEach);async.applyEachSeries=doSeries(_applyEach);async.forever=function(fn,callback){function next(err){if(err){if(callback){return callback(err)}throw err}fn(next)}next()};if(typeof define!=="undefined"&&define.amd){define([],function(){return async})}else if(typeof module!=="undefined"&&module.exports){module.exports=async}else{root.async=async}})()}).call(this,_dereq_("/home/doehlman/.bashinate/install/node/0.10.26/lib/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/home/doehlman/.bashinate/install/node/0.10.26/lib/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5}],13:[function(_dereq_,module,exports){"use strict";module.exports=function(target){target=target||{};[].slice.call(arguments,1).forEach(function(source){if(!source){return}for(var prop in source){if(target[prop]===void 0){target[prop]=source[prop]}}});return target}},{}],14:[function(_dereq_,module,exports){"use strict";module.exports=function(target){[].slice.call(arguments,1).forEach(function(source){if(!source){return}for(var prop in source){target[prop]=source[prop]}});return target}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports=function(input){var isString=typeof input=="string"||input instanceof String;var reNumeric=/^\-?\d+\.?\d*$/;var shouldParse;var firstChar;var lastChar;if(!isString||input.length<2){if(isString&&reNumeric.test(input)){return parseFloat(input)}return input}if(input==="true"||input==="false"){return input==="true"}if(input==="null"){return null}firstChar=input.charAt(0);lastChar=input.charAt(input.length-1);shouldParse=firstChar=="{"&&lastChar=="}"||firstChar=="["&&lastChar=="]";if(shouldParse){try{return JSON.parse(input)}catch(e){}}return reNumeric.test(input)?parseFloat(input):input}},{}],16:[function(_dereq_,module,exports){"use strict";var active=[];var unleashListeners=[];var targets=[console];var logger=module.exports=function(name){var enabled=checkActive();function checkActive(){return enabled=active.indexOf("*")>=0||active.indexOf(name)>=0}unleashListeners[unleashListeners.length]=checkActive;return function(){var args=[].slice.call(arguments);if(typeof args[0]=="string"||args[0]instanceof String){args[0]=name+": "+args[0]}if(!enabled){return}targets.forEach(function(target){target.log.apply(target,args)})}};logger.reset=function(){targets=[];active=[];return logger.enable()};logger.to=function(target){targets=targets.concat(target||[]);return logger};logger.enable=function(){active=active.concat([].slice.call(arguments));unleashListeners.forEach(function(listener){listener()});return logger}},{}],17:[function(_dereq_,module,exports){"use strict";module.exports=function(fn,delay,opts){var lastExec=(opts||{}).leading!==false?0:Date.now();var trailing=(opts||{}).trailing;var timer;var queuedArgs;var queuedScope;trailing=trailing||trailing===undefined;function invokeDefered(){fn.apply(queuedScope,queuedArgs||[]);lastExec=Date.now()}return function(){var tick=Date.now();var elapsed=tick-lastExec;clearTimeout(timer);if(elapsed<delay){queuedArgs=[].slice.call(arguments,0);queuedScope=this;return trailing&&(timer=setTimeout(invokeDefered,delay-elapsed))}lastExec=tick;fn.apply(this,arguments)}}},{}],18:[function(_dereq_,module,exports){"use strict";var browsers={chrome:/Chrom(?:e|ium)\/([0-9]+)\./,firefox:/Firefox\/([0-9]+)\./,opera:/Opera\/([0-9]+)\./};var detect=module.exports=function(target,prefixes){var prefixIdx;var prefix;var testName;var hostObject=this||(typeof window!="undefined"?window:undefined);if(!hostObject){return}prefixes=(prefixes||["ms","o","moz","webkit"]).concat("");for(prefixIdx=prefixes.length;prefixIdx--;){prefix=prefixes[prefixIdx];testName=prefix+(prefix?target.charAt(0).toUpperCase()+target.slice(1):target);if(typeof hostObject[testName]!="undefined"){detect.browser=detect.browser||prefix.toLowerCase();return hostObject[target]=hostObject[testName]}}};detect.moz=typeof navigator!="undefined"&&!!navigator.mozGetUserMedia;if(typeof navigator!="undefined"){Object.keys(browsers).forEach(function(key){var match=browsers[key].exec(navigator.userAgent);if(match){detect.browser=key;detect.browserVersion=detect.version=parseInt(match[1],10)}})}else{detect.browser="node";detect.browserVersion=detect.version="?"}},{}],19:[function(_dereq_,module,exports){"use strict";var debug=_dereq_("cog/logger")("rtc-signaller");var extend=_dereq_("cog/extend");var roles=["a","b"];module.exports=function(signaller){function copyData(target,source){if(target&&source){for(var key in source){target[key]=source[key]}}return target}function dataAllowed(data){var evt={data:data,allow:true};signaller.emit("peer:filter",evt);return evt.allow}return function(args,messageType,srcData,srcState,isDM){var data=args[0];var peer;debug("announce handler invoked, received data: ",data);if(data&&data.id&&data.id!==signaller.id){if(!dataAllowed(data)){return}peer=signaller.peers.get(data.id);if(peer&&!peer.inactive){debug("signaller: "+signaller.id+" received update, data: ",data);copyData(peer.data,data);return signaller.emit("peer:update",data,srcData)}peer={id:data.id,roleIdx:[data.id,signaller.id].sort().indexOf(data.id),data:{}};copyData(peer.data,data);signaller.peers.set(data.id,peer);if(signaller.autoreply&&!isDM){signaller.to(data.id).send("/announce",signaller.attributes)}return signaller.emit("peer:announce",data,peer)}}}},{"cog/extend":14,"cog/logger":16}],20:[function(_dereq_,module,exports){"use strict";module.exports=function(signaller){return{announce:_dereq_("./announce")(signaller),leave:_dereq_("./leave")(signaller)}}},{"./announce":19,"./leave":21}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(signaller){return function(args){var data=args[0];var peer=signaller.peers.get(data&&data.id);if(peer){peer.inactive=true}signaller.emit("peer:leave",data.id,peer)}}},{}],22:[function(_dereq_,module,exports){"use strict";var debug=_dereq_("cog/logger")("rtc-signaller");var detect=_dereq_("rtc-core/detect");var EventEmitter=_dereq_("events").EventEmitter;var uuid=_dereq_("uuid");var extend=_dereq_("cog/extend");var throttle=_dereq_("cog/throttle");var FastMap=_dereq_("collections/fast-map");var metadata={version:"0.19.0"};var sig=module.exports=function(messenger,opts){var autoreply=(opts||{}).autoreply;var signaller=new EventEmitter;var id=signaller.id=(opts||{}).id||uuid.v4();var attributes=signaller.attributes={browser:detect.browser,browserVersion:detect.browserVersion,id:id,agent:"signaller@"+metadata.version};var peers=signaller.peers=new FastMap;var dataEvent=(opts||{}).dataEvent||"data";var openEvent=(opts||{}).openEvent||"open";var writeMethod=(opts||{}).writeMethod||"write";var closeMethod=(opts||{}).closeMethod||"close";var initialized=false;var write;var close;var processor;var announceTimer=0;function connectToPrimus(url){sig.loadPrimus(url,function(err,Primus){if(err){return signaller.emit("error",err)}messenger=Primus.connect(url);init()})}function init(){write=messenger[writeMethod];close=messenger[closeMethod];processor=_dereq_("./processor")(signaller);if(typeof write!="function"){throw new Error('provided messenger does not implement a "'+writeMethod+'" write method')}messenger.on(dataEvent,processor);messenger.on(openEvent,function(){signaller.emit("open");signaller.emit("connected")});initialized=true;signaller.emit("init")}signaller.autoreply=autoreply===undefined||autoreply;function prepareArg(arg){if(typeof arg=="object"&&!(arg instanceof String)){return JSON.stringify(arg)}else if(typeof arg=="function"){return null}return arg}var send=signaller.send=function(){var args=[].slice.call(arguments);var dataline;args.splice(1,0,{id:signaller.id});dataline=args.map(prepareArg).filter(Boolean).join("|");if(!initialized){return signaller.once("init",function(){write.call(messenger,dataline)})}return write.call(messenger,dataline)};signaller.announce=function(data,sender){clearTimeout(announceTimer);extend(attributes,data,{id:signaller.id});return announceTimer=setTimeout(function(){(sender||send)("/announce",attributes)},(opts||{}).announceDelay||10)};signaller.isMaster=function(targetId){var peer=peers.get(targetId);return peer&&peer.roleIdx!==0};signaller.leave=function(){send("/leave",{id:id});if(typeof close=="function"){close.call(messenger)}};signaller.to=function(targetId){var sender=function(){var peer=signaller.peers.get(targetId);var args;if(!peer){throw new Error("Unknown peer: "+targetId)}if(peer.inactive){return}args=["/to",targetId].concat([].slice.call(arguments));args.splice(3,0,{id:signaller.id});setTimeout(function(){var msg=args.map(prepareArg).filter(Boolean).join("|");debug("TX ("+targetId+"): "+msg);write.call(messenger,msg)},0)};return{announce:function(data){return signaller.announce(data,sender)},send:sender}};if(typeof messenger=="string"||messenger instanceof String){connectToPrimus(messenger)}else{init()}return signaller};sig.loadPrimus=_dereq_("./primus-loader")},{"./primus-loader":43,"./processor":44,"cog/extend":14,"cog/logger":16,"cog/throttle":17,"collections/fast-map":24,events:4,"rtc-core/detect":18,uuid:51}],23:[function(_dereq_,module,exports){"use strict";var Shim=_dereq_("./shim");var GenericCollection=_dereq_("./generic-collection");var GenericMap=_dereq_("./generic-map");var ObservableObject=_dereq_("./observable-object");module.exports=Dict;function Dict(values,getDefault){if(!(this instanceof Dict)){return new Dict(values,getDefault)}getDefault=getDefault||this.getDefault;this.getDefault=getDefault;this.store={};this.length=0;this.addEach(values)}Dict.Dict=Dict;function mangle(key){return"~"+key}function unmangle(mangled){return mangled.slice(1)}Object.addEach(Dict.prototype,GenericCollection.prototype);Object.addEach(Dict.prototype,GenericMap.prototype);Object.addEach(Dict.prototype,ObservableObject.prototype);Dict.prototype.isDict=true;Dict.prototype.constructClone=function(values){return new this.constructor(values,this.mangle,this.getDefault)};Dict.prototype.assertString=function(key){if(typeof key!=="string"){throw new TypeError("key must be a string but Got "+key)}};Dict.prototype.get=function(key,defaultValue){this.assertString(key);var mangled=mangle(key);if(mangled in this.store){return this.store[mangled]}else if(arguments.length>1){return defaultValue}else{return this.getDefault(key)}};Dict.prototype.set=function(key,value){this.assertString(key);var mangled=mangle(key);var from;if(mangled in this.store){if(this.dispatchesMapChanges){from=this.store[mangled];this.dispatchMapWillChange("update",key,value,from)}this.store[mangled]=value;if(this.dispatchesMapChanges){this.dispatchMapChange("update",key,value,from)}return false}else{if(this.dispatchesMapChanges){this.dispatchMapWillChange("create",key,value)}this.length++;this.store[mangled]=value;if(this.dispatchesMapChanges){this.dispatchMapChange("create",key,value)}return true}};Dict.prototype.has=function(key){this.assertString(key);var mangled=mangle(key);return mangled in this.store};Dict.prototype["delete"]=function(key){this.assertString(key);var mangled=mangle(key);var from;if(mangled in this.store){if(this.dispatchesMapChanges){from=this.store[mangled];this.dispatchMapWillChange("delete",key,void 0,from)}delete this.store[mangle(key)];this.length--;if(this.dispatchesMapChanges){this.dispatchMapChange("delete",key,void 0,from)}return true}return false};Dict.prototype.clear=function(){var key,mangled,from;for(mangled in this.store){key=unmangle(mangled);if(this.dispatchesMapChanges){from=this.store[mangled];this.dispatchMapWillChange("delete",key,void 0,from)}delete this.store[mangled];if(this.dispatchesMapChanges){this.dispatchMapChange("delete",key,void 0,from)}}this.length=0};Dict.prototype.reduce=function(callback,basis,thisp){for(var mangled in this.store){basis=callback.call(thisp,basis,this.store[mangled],unmangle(mangled),this)}return basis};Dict.prototype.reduceRight=function(callback,basis,thisp){var self=this;var store=this.store;return Object.keys(this.store).reduceRight(function(basis,mangled){return callback.call(thisp,basis,store[mangled],unmangle(mangled),self)},basis)};Dict.prototype.one=function(){var key;for(key in this.store){return this.store[key]}}},{"./generic-collection":26,"./generic-map":27,"./observable-object":34,"./shim":40}],24:[function(_dereq_,module,exports){"use strict";var Shim=_dereq_("./shim");var Set=_dereq_("./fast-set");var GenericCollection=_dereq_("./generic-collection");var GenericMap=_dereq_("./generic-map");var ObservableObject=_dereq_("./observable-object");module.exports=FastMap;function FastMap(values,equals,hash,getDefault){if(!(this instanceof FastMap)){return new FastMap(values,equals,hash,getDefault)}equals=equals||Object.equals;hash=hash||Object.hash;getDefault=getDefault||this.getDefault;this.contentEquals=equals;this.contentHash=hash;this.getDefault=getDefault;this.store=new Set(undefined,function keysEqual(a,b){return equals(a.key,b.key)},function keyHash(item){return hash(item.key)});this.length=0;this.addEach(values)}FastMap.FastMap=FastMap;Object.addEach(FastMap.prototype,GenericCollection.prototype);Object.addEach(FastMap.prototype,GenericMap.prototype);Object.addEach(FastMap.prototype,ObservableObject.prototype);FastMap.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};FastMap.prototype.log=function(charmap,stringify){stringify=stringify||this.stringify;this.store.log(charmap,stringify)};FastMap.prototype.stringify=function(item,leader){return leader+JSON.stringify(item.key)+": "+JSON.stringify(item.value)}},{"./fast-set":25,"./generic-collection":26,"./generic-map":27,"./observable-object":34,"./shim":40}],25:[function(_dereq_,module,exports){"use strict";var Shim=_dereq_("./shim");var Dict=_dereq_("./dict");var List=_dereq_("./list");var GenericCollection=_dereq_("./generic-collection");var GenericSet=_dereq_("./generic-set");var TreeLog=_dereq_("./tree-log");var ObservableObject=_dereq_("./observable-object");var object_has=Object.prototype.hasOwnProperty;module.exports=FastSet;function FastSet(values,equals,hash,getDefault){if(!(this instanceof FastSet)){return new FastSet(values,equals,hash,getDefault)}equals=equals||Object.equals;hash=hash||Object.hash;getDefault=getDefault||Function.noop;this.contentEquals=equals;this.contentHash=hash;this.getDefault=getDefault;this.buckets=new this.Buckets(null,this.Bucket);this.length=0;this.addEach(values)}FastSet.FastSet=FastSet;Object.addEach(FastSet.prototype,GenericCollection.prototype);Object.addEach(FastSet.prototype,GenericSet.prototype);Object.addEach(FastSet.prototype,ObservableObject.prototype);FastSet.prototype.Buckets=Dict;FastSet.prototype.Bucket=List;FastSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};FastSet.prototype.has=function(value){var hash=this.contentHash(value);return this.buckets.get(hash).has(value)};FastSet.prototype.get=function(value){var hash=this.contentHash(value);var buckets=this.buckets;if(buckets.has(hash)){return buckets.get(hash).get(value)}else{return this.getDefault(value)}};FastSet.prototype["delete"]=function(value){var hash=this.contentHash(value);var buckets=this.buckets;if(buckets.has(hash)){var bucket=buckets.get(hash);if(bucket["delete"](value)){this.length--;if(bucket.length===0){buckets["delete"](hash)}return true}}return false};FastSet.prototype.clear=function(){this.buckets.clear();this.length=0};FastSet.prototype.add=function(value){var hash=this.contentHash(value);var buckets=this.buckets;if(!buckets.has(hash)){buckets.set(hash,new this.Bucket(null,this.contentEquals))}if(!buckets.get(hash).has(value)){buckets.get(hash).add(value);this.length++;return true}return false};FastSet.prototype.reduce=function(callback,basis){var thisp=arguments[2];var buckets=this.buckets;var index=0;return buckets.reduce(function(basis,bucket){return bucket.reduce(function(basis,value){return callback.call(thisp,basis,value,index++,this)},basis,this)},basis,this)};FastSet.prototype.one=function(){if(this.length>0){return this.buckets.one().one()}};FastSet.prototype.iterate=function(){return this.buckets.values().flatten().iterate()};FastSet.prototype.log=function(charmap,logNode,callback,thisp){charmap=charmap||TreeLog.unicodeSharp;logNode=logNode||this.logNode;if(!callback){callback=console.log;thisp=console}var originalCallback=callback;callback=function(){return originalCallback.apply(thisp,arguments)};var buckets=this.buckets;var hashes=buckets.keys();hashes.forEach(function(hash,index){var branch;var leader;if(index===hashes.length-1){branch=charmap.fromAbove;leader=" "}else if(index===0){branch=charmap.branchDown;leader=charmap.strafe}else{branch=charmap.fromBoth;leader=charmap.strafe}var bucket=buckets.get(hash);callback.call(thisp,branch+charmap.through+charmap.branchDown+" "+hash);bucket.forEach(function(value,node){var branch,below;if(node===bucket.head.prev){branch=charmap.fromAbove;below=" "}else{branch=charmap.fromBoth;below=charmap.strafe}var written;logNode(node,function(line){if(!written){callback.call(thisp,leader+" "+branch+charmap.through+charmap.through+line);written=true}else{callback.call(thisp,leader+" "+below+"  "+line)}},function(line){callback.call(thisp,leader+" "+charmap.strafe+"  "+line)})})})};FastSet.prototype.logNode=function(node,write){var value=node.value;if(Object(value)===value){JSON.stringify(value,null,4).split("\n").forEach(function(line){write(" "+line)})}else{write(" "+value)}}},{"./dict":23,"./generic-collection":26,"./generic-set":29,"./list":31,"./observable-object":34,"./shim":40,"./tree-log":41}],26:[function(_dereq_,module,exports){"use strict";module.exports=GenericCollection;function GenericCollection(){throw new Error("Can't construct. GenericCollection is a mixin.")}GenericCollection.prototype.addEach=function(values){if(values&&Object(values)===values){if(typeof values.forEach==="function"){values.forEach(this.add,this)}else if(typeof values.length==="number"){for(var i=0;i<values.length;i++){this.add(values[i],i)}}else{Object.keys(values).forEach(function(key){this.add(values[key],key)},this)}}return this};GenericCollection.prototype.deleteEach=function(values,equals){values.forEach(function(value){this["delete"](value,equals)},this);return this};GenericCollection.prototype.forEach=function(callback){var thisp=arguments[1];return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,key,object,depth)},undefined)};GenericCollection.prototype.map=function(callback){var thisp=arguments[1];var result=[];this.reduce(function(undefined,value,key,object,depth){result.push(callback.call(thisp,value,key,object,depth))},undefined);return result};GenericCollection.prototype.enumerate=function(start){if(start==null){start=0}var result=[];this.reduce(function(undefined,value){result.push([start++,value])},undefined);return result};GenericCollection.prototype.group=function(callback,thisp,equals){equals=equals||Object.equals;var groups=[];var keys=[];this.forEach(function(value,key,object){var key=callback.call(thisp,value,key,object);var index=keys.indexOf(key,equals);var group;if(index===-1){group=[];groups.push([key,group]);keys.push(key)}else{group=groups[index][1]}group.push(value)});return groups};GenericCollection.prototype.toArray=function(){return this.map(Function.identity)};GenericCollection.prototype.toObject=function(){var object={};this.reduce(function(undefined,value,key){object[key]=value},undefined);return object};GenericCollection.prototype.filter=function(callback){var thisp=arguments[1];var result=this.constructClone();this.reduce(function(undefined,value,key,object,depth){if(callback.call(thisp,value,key,object,depth)){result.add(value,key)}},undefined);return result};GenericCollection.prototype.every=function(callback){var thisp=arguments[1];var iterator=this.iterate();while(true){var iteration=iterator.next();if(iteration.done){return true}else if(!callback.call(thisp,iteration.value,iteration.index,this)){return false}}};GenericCollection.prototype.some=function(callback){var thisp=arguments[1];var iterator=this.iterate();while(true){var iteration=iterator.next();if(iteration.done){return false}else if(callback.call(thisp,iteration.value,iteration.index,this)){return true}}};GenericCollection.prototype.min=function(compare){compare=compare||this.contentCompare||Object.compare;var first=true;return this.reduce(function(result,value){if(first){first=false;return value}else{return compare(value,result)<0?value:result}},undefined)};GenericCollection.prototype.max=function(compare){compare=compare||this.contentCompare||Object.compare;var first=true;return this.reduce(function(result,value){if(first){first=false;return value}else{return compare(value,result)>0?value:result}},undefined)};GenericCollection.prototype.sum=function(zero){zero=zero===undefined?0:zero;return this.reduce(function(a,b){return a+b},zero)};GenericCollection.prototype.average=function(zero){var sum=zero===undefined?0:zero;var count=zero===undefined?0:zero;this.reduce(function(undefined,value){sum+=value;count+=1},undefined);return sum/count};GenericCollection.prototype.concat=function(){var result=this.constructClone(this);for(var i=0;i<arguments.length;i++){result.addEach(arguments[i])}return result};GenericCollection.prototype.flatten=function(){var self=this;return this.reduce(function(result,array){array.forEach(function(value){this.push(value)},result,self);return result},[])};GenericCollection.prototype.zip=function(){var table=Array.prototype.slice.call(arguments);table.unshift(this);return Array.unzip(table)};GenericCollection.prototype.join=function(delimiter){return this.reduce(function(result,string){return result+delimiter+string})};GenericCollection.prototype.sorted=function(compare,by,order){compare=compare||this.contentCompare||Object.compare;if(compare.by){by=compare.by;compare=compare.compare||this.contentCompare||Object.compare}else{by=by||Function.identity}if(order===undefined)order=1;return this.map(function(item){return{by:by(item),value:item}}).sort(function(a,b){return compare(a.by,b.by)*order}).map(function(pair){return pair.value})};GenericCollection.prototype.reversed=function(){return this.constructClone(this).reverse()};GenericCollection.prototype.clone=function(depth,memo){if(depth===undefined){depth=Infinity}else if(depth===0){return this}var clone=this.constructClone();this.forEach(function(value,key){clone.add(Object.clone(value,depth-1,memo),key)},this);return clone};GenericCollection.prototype.only=function(){if(this.length===1){return this.one()}};_dereq_("./shim-array")},{"./shim-array":36}],27:[function(_dereq_,module,exports){"use strict";var Object=_dereq_("./shim-object");var ObservableMap=_dereq_("./observable-map");var ObservableObject=_dereq_("./observable-object");var Iterator=_dereq_("./iterator");module.exports=GenericMap;function GenericMap(){throw new Error("Can't construct. GenericMap is a mixin.")}Object.addEach(GenericMap.prototype,ObservableMap.prototype);Object.addEach(GenericMap.prototype,ObservableObject.prototype);GenericMap.prototype.isMap=true;GenericMap.prototype.addEach=function(values){if(values&&Object(values)===values){if(typeof values.forEach==="function"){if(values.isMap===true){values.forEach(function(value,key){this.set(key,value)},this)}else{values.forEach(function(pair){this.set(pair[0],pair[1])},this)}}else{Object.keys(values).forEach(function(key){this.set(key,values[key])},this)}}return this};GenericMap.prototype.get=function(key,defaultValue){var item=this.store.get(new this.Item(key));if(item){return item.value}else if(arguments.length>1){return defaultValue}else{return this.getDefault(key)}};GenericMap.prototype.getDefault=function(){};GenericMap.prototype.set=function(key,value){var item=new this.Item(key,value);var found=this.store.get(item);var grew=false;if(found){var from;if(this.dispatchesMapChanges){from=found.value;this.dispatchMapWillChange("update",key,value,from)}found.value=value;if(this.dispatchesMapChanges){this.dispatchMapChange("update",key,value,from)}}else{if(this.dispatchesMapChanges){this.dispatchMapWillChange("create",key,value)}if(this.store.add(item)){this.length++;grew=true}if(this.dispatchesMapChanges){this.dispatchMapChange("create",key,value)}}return grew};GenericMap.prototype.add=function(value,key){return this.set(key,value)};GenericMap.prototype.has=function(key){return this.store.has(new this.Item(key))};GenericMap.prototype["delete"]=function(key){var item=new this.Item(key);if(this.store.has(item)){var from;if(this.dispatchesMapChanges){from=this.store.get(item).value;this.dispatchMapWillChange("delete",key,void 0,from)}this.store["delete"](item);this.length--;if(this.dispatchesMapChanges){this.dispatchMapChange("delete",key,void 0,from)}return true}return false};GenericMap.prototype.clear=function(){var from;if(this.dispatchesMapChanges){this.forEach(function(value,key){this.dispatchMapWillChange("delete",key,void 0,value)},this);from=this.constructClone(this)}this.store.clear();this.length=0;if(this.dispatchesMapChanges){from.forEach(function(value,key){this.dispatchMapChange("delete",key,void 0,value)},this)}};GenericMap.prototype.iterate=function(){return new GenericMapIterator(this)};GenericMap.prototype.reduce=function(callback,basis,thisp){return this.store.reduce(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)};GenericMap.prototype.reduceRight=function(callback,basis,thisp){return this.store.reduceRight(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)};GenericMap.prototype.keys=function(){return this.map(function(value,key){return key})};GenericMap.prototype.values=function(){return this.map(Function.identity)};GenericMap.prototype.entries=function(){return this.map(function(value,key){return[key,value]})};GenericMap.prototype.items=function(){return this.entries()};GenericMap.prototype.equals=function(that,equals){equals=equals||Object.equals;if(this===that){return true}else if(that&&typeof that.every==="function"){return that.length===this.length&&that.every(function(value,key){return equals(this.get(key),value)},this)}else{var keys=Object.keys(that);return keys.length===this.length&&Object.keys(that).every(function(key){return equals(this.get(key),that[key])},this)}};GenericMap.prototype.Item=Item;function Item(key,value){this.key=key;this.value=value}Item.prototype.equals=function(that){return Object.equals(this.key,that.key)&&Object.equals(this.value,that.value)};Item.prototype.compare=function(that){return Object.compare(this.key,that.key)};function GenericMapIterator(map){this.map=map;this.iterator=map.store.iterate()}GenericMapIterator.prototype=Object.create(Iterator.prototype);GenericMapIterator.prototype.constructor=GenericMapIterator;GenericMapIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){return iteration}else{return new Iterator.Iteration(iteration.value[1],iteration.value[0])}}},{"./iterator":30,"./observable-map":33,"./observable-object":34,"./shim-object":38}],28:[function(_dereq_,module,exports){var Object=_dereq_("./shim-object");module.exports=GenericOrder;function GenericOrder(){throw new Error("Can't construct. GenericOrder is a mixin.")}GenericOrder.prototype.equals=function(that,equals){equals=equals||this.contentEquals||Object.equals;if(this===that){return true}if(!that){return false}var self=this;return this.length===that.length&&this.zip(that).every(function(pair){return equals(pair[0],pair[1])})};GenericOrder.prototype.compare=function(that,compare){compare=compare||this.contentCompare||Object.compare;if(this===that){return 0}if(!that){return 1}var length=Math.min(this.length,that.length);var comparison=this.zip(that).reduce(function(comparison,pair,index){if(comparison===0){if(index>=length){return comparison}else{return compare(pair[0],pair[1])}}else{return comparison}},0);if(comparison===0){return this.length-that.length}return comparison}},{"./shim-object":38}],29:[function(_dereq_,module,exports){module.exports=GenericSet;function GenericSet(){throw new Error("Can't construct. GenericSet is a mixin.")}GenericSet.prototype.isSet=true;GenericSet.prototype.union=function(that){var union=this.constructClone(this);
union.addEach(that);return union};GenericSet.prototype.intersection=function(that){return this.constructClone(this.filter(function(value){return that.has(value)}))};GenericSet.prototype.difference=function(that){var union=this.constructClone(this);union.deleteEach(that);return union};GenericSet.prototype.symmetricDifference=function(that){var union=this.union(that);var intersection=this.intersection(that);return union.difference(intersection)};GenericSet.prototype.equals=function(that,equals){var self=this;return that&&typeof that.reduce==="function"&&this.length===that.length&&that.reduce(function(equal,value){return equal&&self.has(value,equals)},true)};GenericSet.prototype.contains=function(value){return this.has(value)};GenericSet.prototype.remove=function(value){return this["delete"](value)};GenericSet.prototype.toggle=function(value){if(this.has(value)){this["delete"](value)}else{this.add(value)}}},{}],30:[function(_dereq_,module,exports){"use strict";module.exports=Iterator;var WeakMap=_dereq_("./weak-map");var GenericCollection=_dereq_("./generic-collection");function Iterator(iterable,start,stop,step){if(!iterable){return Iterator.empty}else if(iterable instanceof Iterator){return iterable}else if(!(this instanceof Iterator)){return new Iterator(iterable,start,stop,step)}else if(Array.isArray(iterable)||typeof iterable==="string"){iterators.set(this,new IndexIterator(iterable,start,stop,step));return}iterable=Object(iterable);if(iterable.next){iterators.set(this,iterable)}else if(iterable.iterate){iterators.set(this,iterable.iterate(start,stop,step))}else if(Object.prototype.toString.call(iterable)==="[object Function]"){this.next=iterable}else{throw new TypeError("Can't iterate "+iterable)}}var iterators=new WeakMap;Iterator.prototype.forEach=GenericCollection.prototype.forEach;Iterator.prototype.map=GenericCollection.prototype.map;Iterator.prototype.filter=GenericCollection.prototype.filter;Iterator.prototype.every=GenericCollection.prototype.every;Iterator.prototype.some=GenericCollection.prototype.some;Iterator.prototype.min=GenericCollection.prototype.min;Iterator.prototype.max=GenericCollection.prototype.max;Iterator.prototype.sum=GenericCollection.prototype.sum;Iterator.prototype.average=GenericCollection.prototype.average;Iterator.prototype.flatten=GenericCollection.prototype.flatten;Iterator.prototype.zip=GenericCollection.prototype.zip;Iterator.prototype.enumerate=GenericCollection.prototype.enumerate;Iterator.prototype.sorted=GenericCollection.prototype.sorted;Iterator.prototype.group=GenericCollection.prototype.group;Iterator.prototype.reversed=GenericCollection.prototype.reversed;Iterator.prototype.toArray=GenericCollection.prototype.toArray;Iterator.prototype.toObject=GenericCollection.prototype.toObject;Iterator.prototype.constructClone=function(values){var clone=[];clone.addEach(values);return clone};Iterator.prototype.next=function(){var nextable=iterators.get(this);if(nextable){return nextable.next()}else{return Iterator.done}};Iterator.prototype.iterateMap=function(callback){var self=Iterator(this),thisp=arguments[1];return new MapIterator(self,callback,thisp)};function MapIterator(iterator,callback,thisp){this.iterator=iterator;this.callback=callback;this.thisp=thisp}MapIterator.prototype=Object.create(Iterator.prototype);MapIterator.prototype.constructor=MapIterator;MapIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){return iteration}else{return new Iteration(this.callback.call(this.thisp,iteration.value,iteration.index,this.iteration),iteration.index)}};Iterator.prototype.iterateFilter=function(callback){var self=Iterator(this),thisp=arguments[1],index=0;return new FilterIterator(self,callback,thisp)};function FilterIterator(iterator,callback,thisp){this.iterator=iterator;this.callback=callback;this.thisp=thisp}FilterIterator.prototype=Object.create(Iterator.prototype);FilterIterator.prototype.constructor=FilterIterator;FilterIterator.prototype.next=function(){var iteration;while(true){iteration=this.iterator.next();if(iteration.done||this.callback.call(this.thisp,iteration.value,iteration.index,this.iteration)){return iteration}}};Iterator.prototype.reduce=function(callback){var self=Iterator(this),result=arguments[1],thisp=arguments[2],iteration;iteration=self.next();if(iteration.done){if(arguments.length>1){return arguments[1]}else{throw TypeError("Reduce of empty iterator with no initial value")}}else if(arguments.length>1){result=callback.call(thisp,result,iteration.value,iteration.index,self)}else{result=iteration.value}while(true){iteration=self.next();if(iteration.done){return result}else{result=callback.call(thisp,result,iteration.value,iteration.index,self)}}};Iterator.prototype.dropWhile=function(callback){var self=Iterator(this),thisp=arguments[1],iteration;while(true){iteration=self.next();if(iteration.done){return Iterator.empty}else if(!callback.call(thisp,iteration.value,iteration.index,self)){return new DropWhileIterator(iteration,self)}}};function DropWhileIterator(iteration,iterator){this.iteration=iteration;this.iterator=iterator;this.parent=null}DropWhileIterator.prototype=Object.create(Iterator.prototype);DropWhileIterator.prototype.constructor=DropWhileIterator;DropWhileIterator.prototype.next=function(){var result=this.iteration;if(result){this.iteration=null;return result}else{return this.iterator.next()}};Iterator.prototype.takeWhile=function(callback){var self=Iterator(this),thisp=arguments[1];return new TakeWhileIterator(self,callback,thisp)};function TakeWhileIterator(iterator,callback,thisp){this.iterator=iterator;this.callback=callback;this.thisp=thisp}TakeWhileIterator.prototype=Object.create(Iterator.prototype);TakeWhileIterator.prototype.constructor=TakeWhileIterator;TakeWhileIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){return iteration}else if(this.callback.call(this.thisp,iteration.value,iteration.index,this.iterator)){return iteration}else{return Iterator.done}};Iterator.prototype.iterateZip=function(){return Iterator.unzip(Array.prototype.concat.apply(this,arguments))};Iterator.prototype.iterateUnzip=function(){return Iterator.unzip(this)};Iterator.prototype.iterateEnumerate=function(start){return Iterator.count(start).iterateZip(this)};Iterator.prototype.iterateConcat=function(){return Iterator.flatten(Array.prototype.concat.apply(this,arguments))};Iterator.prototype.iterateFlatten=function(){return Iterator.flatten(this)};Iterator.prototype.recount=function(start){return new RecountIterator(this,start)};function RecountIterator(iterator,start){this.iterator=iterator;this.index=start||0}RecountIterator.prototype=Object.create(Iterator.prototype);RecountIterator.prototype.constructor=RecountIterator;RecountIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){return iteration}else{return new Iteration(iteration.value,this.index++)}};function IndexIterator(iterable,start,stop,step){if(step==null){step=1}if(stop==null){stop=start;start=0}if(start==null){start=0}if(step==null){step=1}if(stop==null){stop=iterable.length}this.iterable=iterable;this.start=start;this.stop=stop;this.step=step}IndexIterator.prototype.next=function(){if(typeof this.iterable==="object"){while(!(this.start in this.iterable)){if(this.start>=this.stop){return Iterator.done}else{this.start+=this.step}}}if(this.start>=this.stop){return Iterator.done}var iteration=new Iteration(this.iterable[this.start],this.start);this.start+=this.step;return iteration};Iterator.cycle=function(cycle,times){if(arguments.length<2){times=Infinity}return new CycleIterator(cycle,times)};function CycleIterator(cycle,times){this.cycle=cycle;this.times=times;this.iterator=Iterator.empty}CycleIterator.prototype=Object.create(Iterator.prototype);CycleIterator.prototype.constructor=CycleIterator;CycleIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){if(this.times>0){this.times--;this.iterator=new Iterator(this.cycle);return this.iterator.next()}else{return iteration}}else{return iteration}};Iterator.concat=function(){return Iterator.flatten(Array.prototype.slice.call(arguments))};Iterator.flatten=function(iterators){iterators=Iterator(iterators);return new ChainIterator(iterators)};function ChainIterator(iterators){this.iterators=iterators;this.iterator=Iterator.empty}ChainIterator.prototype=Object.create(Iterator.prototype);ChainIterator.prototype.constructor=ChainIterator;ChainIterator.prototype.next=function(){var iteration=this.iterator.next();if(iteration.done){var iteratorIteration=this.iterators.next();if(iteratorIteration.done){return Iterator.done}else{this.iterator=new Iterator(iteratorIteration.value);return this.iterator.next()}}else{return iteration}};Iterator.unzip=function(iterators){iterators=Iterator(iterators).map(Iterator);if(iterators.length===0)return new Iterator.empty;return new UnzipIterator(iterators)};function UnzipIterator(iterators){this.iterators=iterators;this.index=0}UnzipIterator.prototype=Object.create(Iterator.prototype);UnzipIterator.prototype.constructor=UnzipIterator;UnzipIterator.prototype.next=function(){var done=false;var result=this.iterators.map(function(iterator){var iteration=iterator.next();if(iteration.done){done=true}else{return iteration.value}});if(done){return Iterator.done}else{return new Iteration(result,this.index++)}};Iterator.zip=function(){return Iterator.unzip(Array.prototype.slice.call(arguments))};Iterator.range=function(start,stop,step){if(arguments.length<3){step=1}if(arguments.length<2){stop=start;start=0}start=start||0;step=step||1;return new RangeIterator(start,stop,step)};Iterator.count=function(start,step){return Iterator.range(start,Infinity,step)};function RangeIterator(start,stop,step){this.start=start;this.stop=stop;this.step=step;this.index=0}RangeIterator.prototype=Object.create(Iterator.prototype);RangeIterator.prototype.constructor=RangeIterator;RangeIterator.prototype.next=function(){if(this.start>=this.stop){return Iterator.done}else{var result=this.start;this.start+=this.step;return new Iteration(result,this.index++)}};Iterator.repeat=function(value,times){if(times==null){times=Infinity}return new RepeatIterator(value,times)};function RepeatIterator(value,times){this.value=value;this.times=times;this.index=0}RepeatIterator.prototype=Object.create(Iterator.prototype);RepeatIterator.prototype.constructor=RepeatIterator;RepeatIterator.prototype.next=function(){if(this.index<this.times){return new Iteration(this.value,this.index++)}else{return Iterator.done}};Iterator.enumerate=function(values,start){return Iterator.count(start).iterateZip(new Iterator(values))};function EmptyIterator(){}EmptyIterator.prototype=Object.create(Iterator.prototype);EmptyIterator.prototype.constructor=EmptyIterator;EmptyIterator.prototype.next=function(){return Iterator.done};Iterator.empty=new EmptyIterator;function Iteration(value,index){this.value=value;this.index=index}Iteration.prototype.done=false;Iteration.prototype.equals=function(that,equals,memo){if(!that)return false;return equals(this.value,that.value,equals,memo)&&this.index===that.index&&this.done===that.done};function DoneIteration(value){Iteration.call(this,value);this.done=true}DoneIteration.prototype=Object.create(Iteration.prototype);DoneIteration.prototype.constructor=DoneIteration;DoneIteration.prototype.done=true;Iterator.Iteration=Iteration;Iterator.DoneIteration=DoneIteration;Iterator.done=new DoneIteration},{"./generic-collection":26,"./weak-map":42}],31:[function(_dereq_,module,exports){"use strict";module.exports=List;var Shim=_dereq_("./shim");var GenericCollection=_dereq_("./generic-collection");var GenericOrder=_dereq_("./generic-order");var ObservableObject=_dereq_("./observable-object");var ObservableRange=_dereq_("./observable-range");var Iterator=_dereq_("./iterator");function List(values,equals,getDefault){if(!(this instanceof List)){return new List(values,equals,getDefault)}var head=this.head=new this.Node;head.next=head;head.prev=head;this.contentEquals=equals||Object.equals;this.getDefault=getDefault||Function.noop;this.length=0;this.addEach(values)}List.List=List;Object.addEach(List.prototype,GenericCollection.prototype);Object.addEach(List.prototype,GenericOrder.prototype);Object.addEach(List.prototype,ObservableObject.prototype);Object.addEach(List.prototype,ObservableRange.prototype);List.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.getDefault)};List.prototype.findValue=function(value,equals){equals=equals||this.contentEquals;var head=this.head;var at=head.next;while(at!==head){if(equals(at.value,value)){return at}at=at.next}};List.prototype.findLastValue=function(value,equals){equals=equals||this.contentEquals;var head=this.head;var at=head.prev;while(at!==head){if(equals(at.value,value)){return at}at=at.prev}};List.prototype.has=function(value,equals){return!!this.findValue(value,equals)};List.prototype.get=function(value,equals){var found=this.findValue(value,equals);if(found){return found.value}return this.getDefault(value)};List.prototype["delete"]=function(value,equals){var found=this.findLastValue(value,equals);if(found){if(this.dispatchesRangeChanges){var plus=[];var minus=[value];this.dispatchRangeWillChange(plus,minus,found.index)}found["delete"]();this.length--;if(this.dispatchesRangeChanges){this.updateIndexes(found.next,found.index);this.dispatchRangeChange(plus,minus,found.index)}return true}return false};List.prototype.clear=function(){var plus,minus;if(this.dispatchesRangeChanges){minus=this.toArray();plus=[];this.dispatchRangeWillChange(plus,minus,0)}this.head.next=this.head.prev=this.head;this.length=0;if(this.dispatchesRangeChanges){this.dispatchRangeChange(plus,minus,0)}};List.prototype.add=function(value){var node=new this.Node(value);if(this.dispatchesRangeChanges){node.index=this.length;this.dispatchRangeWillChange([value],[],node.index)}this.head.addBefore(node);this.length++;if(this.dispatchesRangeChanges){this.dispatchRangeChange([value],[],node.index)}return true};List.prototype.push=function(){var head=this.head;if(this.dispatchesRangeChanges){var plus=Array.prototype.slice.call(arguments);var minus=[];var index=this.length;this.dispatchRangeWillChange(plus,minus,index);var start=this.head.prev}for(var i=0;i<arguments.length;i++){var value=arguments[i];var node=new this.Node(value);head.addBefore(node)}this.length+=arguments.length;if(this.dispatchesRangeChanges){this.updateIndexes(start.next,start.index===undefined?0:start.index+1);this.dispatchRangeChange(plus,minus,index)}};List.prototype.unshift=function(){if(this.dispatchesRangeChanges){var plus=Array.prototype.slice.call(arguments);var minus=[];this.dispatchRangeWillChange(plus,minus,0)}var at=this.head;for(var i=0;i<arguments.length;i++){var value=arguments[i];var node=new this.Node(value);at.addAfter(node);at=node}this.length+=arguments.length;if(this.dispatchesRangeChanges){this.updateIndexes(this.head.next,0);this.dispatchRangeChange(plus,minus,0)}};List.prototype.pop=function(){var value;var head=this.head;if(head.prev!==head){value=head.prev.value;if(this.dispatchesRangeChanges){var plus=[];var minus=[value];var index=this.length-1;this.dispatchRangeWillChange(plus,minus,index)}head.prev["delete"]();this.length--;if(this.dispatchesRangeChanges){this.dispatchRangeChange(plus,minus,index)}}return value};List.prototype.shift=function(){var value;var head=this.head;if(head.prev!==head){value=head.next.value;if(this.dispatchesRangeChanges){var plus=[];var minus=[value];this.dispatchRangeWillChange(plus,minus,0)}head.next["delete"]();this.length--;if(this.dispatchesRangeChanges){this.updateIndexes(this.head.next,0);this.dispatchRangeChange(plus,minus,0)}}return value};List.prototype.peek=function(){if(this.head!==this.head.next){return this.head.next.value}};List.prototype.poke=function(value){if(this.head!==this.head.next){this.head.next.value=value}else{this.push(value)}};List.prototype.one=function(){return this.peek()};List.prototype.scan=function(at,fallback){var head=this.head;if(typeof at==="number"){var count=at;if(count>=0){at=head.next;while(count){count--;at=at.next;if(at==head){break}}}else{at=head;while(count<0){count++;at=at.prev;if(at==head){break}}}return at}else{return at||fallback}};List.prototype.slice=function(at,end){var sliced=[];var head=this.head;at=this.scan(at,head.next);end=this.scan(end,head);while(at!==end&&at!==head){sliced.push(at.value);at=at.next}return sliced};List.prototype.splice=function(at,length){return this.swap(at,length,Array.prototype.slice.call(arguments,2))};List.prototype.swap=function(start,length,plus){var initial=start;start=this.scan(start,this.head);if(length==null){length=Infinity}plus=Array.from(plus);var minus=[];var at=start;while(length--&&length>=0&&at!==this.head){minus.push(at.value);at=at.next}var index,startNode;if(this.dispatchesRangeChanges){if(start===this.head){index=this.length}else if(start.prev===this.head){index=0}else{index=start.index}startNode=start.prev;this.dispatchRangeWillChange(plus,minus,index)}var at=start;for(var i=0,at=start;i<minus.length;i++,at=at.next){at["delete"]()}if(initial==null&&at===this.head){at=this.head.next}for(var i=0;i<plus.length;i++){var node=new this.Node(plus[i]);at.addBefore(node)}this.length+=plus.length-minus.length;if(this.dispatchesRangeChanges){if(start===this.head){this.updateIndexes(this.head.next,0)}else{this.updateIndexes(startNode.next,startNode.index+1)}this.dispatchRangeChange(plus,minus,index)}return minus};List.prototype.reverse=function(){if(this.dispatchesRangeChanges){var minus=this.toArray();var plus=minus.reversed();this.dispatchRangeWillChange(plus,minus,0)}var at=this.head;do{var temp=at.next;at.next=at.prev;at.prev=temp;at=at.next}while(at!==this.head);if(this.dispatchesRangeChanges){this.dispatchRangeChange(plus,minus,0)}return this};List.prototype.sort=function(){this.swap(0,this.length,this.sorted())};List.prototype.reduce=function(callback,basis){var thisp=arguments[2];var head=this.head;var at=head.next;while(at!==head){basis=callback.call(thisp,basis,at.value,at,this);at=at.next}return basis};List.prototype.reduceRight=function(callback,basis){var thisp=arguments[2];var head=this.head;var at=head.prev;while(at!==head){basis=callback.call(thisp,basis,at.value,at,this);at=at.prev}return basis};List.prototype.updateIndexes=function(node,index){while(node!==this.head){node.index=index++;node=node.next}};List.prototype.makeRangeChangesObservable=function(){this.head.index=-1;this.updateIndexes(this.head.next,0);ObservableRange.prototype.makeRangeChangesObservable.call(this)};List.prototype.iterate=function(){return new ListIterator(this.head)};function ListIterator(head){this.head=head;this.at=head.next;this.index=0}ListIterator.prototype=Object.create(Iterator.prototype);ListIterator.prototype.constructor=ListIterator;ListIterator.prototype.next=function(){if(this.at===this.head){return Iterator.done}else{var at=this.at;this.at=this.at.next;return new Iterator.Iteration(at.value,this.index++)}};List.prototype.Node=Node;function Node(value){this.value=value;this.prev=null;this.next=null}Node.prototype["delete"]=function(){this.prev.next=this.next;this.next.prev=this.prev};Node.prototype.addBefore=function(node){var prev=this.prev;this.prev=node;node.prev=prev;prev.next=node;node.next=this};Node.prototype.addAfter=function(node){var next=this.next;this.next=node;node.next=next;next.prev=node;node.prev=this}},{"./generic-collection":26,"./generic-order":28,"./iterator":30,"./observable-object":34,"./observable-range":35,"./shim":40}],32:[function(_dereq_,module,exports){(function WeakMapModule(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function weakMapPermitHostObjects(map){if(map.permitHostObjects___){map.permitHostObjects___(weakMapPermitHostObjects)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=weakMapPermitHostObjects}var doubleWeakMapCheckSilentFailure=false;if(typeof WeakMap==="function"){var HostWeakMap=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var testMap=new HostWeakMap;var testObject=Object.freeze({});testMap.set(testObject,1);if(testMap.get(testObject)!==1){doubleWeakMapCheckSilentFailure=true}else{module.exports=WeakMap;return}}}var hop=Object.prototype.hasOwnProperty;var gopn=Object.getOwnPropertyNames;var defProp=Object.defineProperty;var isExtensible=Object.isExtensible;var HIDDEN_NAME_PREFIX="weakmap:";var HIDDEN_NAME=HIDDEN_NAME_PREFIX+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var ab=new ArrayBuffer(25);var u8s=new Uint8Array(ab);crypto.getRandomValues(u8s);HIDDEN_NAME=HIDDEN_NAME_PREFIX+"rand:"+Array.prototype.map.call(u8s,function(u8){return(u8%36).toString(36)}).join("")+"___"}function isNotHiddenName(name){return!(name.substr(0,HIDDEN_NAME_PREFIX.length)==HIDDEN_NAME_PREFIX&&name.substr(name.length-3)==="___")}defProp(Object,"getOwnPropertyNames",{value:function fakeGetOwnPropertyNames(obj){return gopn(obj).filter(isNotHiddenName)}});if("getPropertyNames"in Object){var originalGetPropertyNames=Object.getPropertyNames;defProp(Object,"getPropertyNames",{value:function fakeGetPropertyNames(obj){return originalGetPropertyNames(obj).filter(isNotHiddenName)}})}function getHiddenRecord(key){if(key!==Object(key)){throw new TypeError("Not an object: "+key)}var hiddenRecord=key[HIDDEN_NAME];if(hiddenRecord&&hiddenRecord.key===key){return hiddenRecord}if(!isExtensible(key)){return void 0}hiddenRecord={key:key};defProp(key,HIDDEN_NAME,{value:hiddenRecord,writable:false,enumerable:false,configurable:false});return hiddenRecord}(function(){var oldFreeze=Object.freeze;defProp(Object,"freeze",{value:function identifyingFreeze(obj){getHiddenRecord(obj);return oldFreeze(obj)}});var oldSeal=Object.seal;defProp(Object,"seal",{value:function identifyingSeal(obj){getHiddenRecord(obj);return oldSeal(obj)}});var oldPreventExtensions=Object.preventExtensions;defProp(Object,"preventExtensions",{value:function identifyingPreventExtensions(obj){getHiddenRecord(obj);return oldPreventExtensions(obj)}})})();function constFunc(func){func.prototype=null;return Object.freeze(func)}var calledAsFunctionWarningDone=false;function calledAsFunctionWarning(){if(!calledAsFunctionWarningDone&&typeof console!=="undefined"){calledAsFunctionWarningDone=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var nextId=0;var OurWeakMap=function(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var keys=[];var values=[];var id=nextId++;function get___(key,opt_default){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord?hiddenRecord[id]:opt_default}else{index=keys.indexOf(key);return index>=0?values[index]:opt_default}}function has___(key){var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord}else{return keys.indexOf(key)>=0}}function set___(key,value){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){hiddenRecord[id]=value}else{index=keys.indexOf(key);if(index>=0){values[index]=value}else{index=keys.length;values[index]=value;keys[index]=key}}return this}function delete___(key){var hiddenRecord=getHiddenRecord(key);var index,lastIndex;if(hiddenRecord){return id in hiddenRecord&&delete hiddenRecord[id]}else{index=keys.indexOf(key);if(index<0){return false}lastIndex=keys.length-1;keys[index]=void 0;values[index]=values[lastIndex];keys[index]=keys[lastIndex];keys.length=lastIndex;values.length=lastIndex;return true}}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(get___)},has___:{value:constFunc(has___)},set___:{value:constFunc(set___)},delete___:{value:constFunc(delete___)}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function get(key,opt_default){return this.get___(key,opt_default)},writable:true,configurable:true},has:{value:function has(key){return this.has___(key)},writable:true,configurable:true},set:{value:function set(key,value){return this.set___(key,value)},writable:true,configurable:true},"delete":{value:function remove(key){return this.delete___(key)},writable:true,configurable:true}});if(typeof HostWeakMap==="function"){(function(){if(doubleWeakMapCheckSilentFailure&&typeof Proxy!=="undefined"){Proxy=undefined}function DoubleWeakMap(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var hmap=new HostWeakMap;var omap=undefined;var enableSwitching=false;function dget(key,opt_default){if(omap){return hmap.has(key)?hmap.get(key):omap.get___(key,opt_default)}else{return hmap.get(key,opt_default)}}function dhas(key){return hmap.has(key)||(omap?omap.has___(key):false)}var dset;if(doubleWeakMapCheckSilentFailure){dset=function(key,value){hmap.set(key,value);if(!hmap.has(key)){if(!omap){omap=new OurWeakMap}omap.set(key,value)}return this}}else{dset=function(key,value){if(enableSwitching){try{hmap.set(key,value)}catch(e){if(!omap){omap=new OurWeakMap}omap.set___(key,value)}}else{hmap.set(key,value)}return this}}function ddelete(key){var result=!!hmap["delete"](key);if(omap){return omap.delete___(key)||result}return result}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(dget)},has___:{value:constFunc(dhas)},set___:{value:constFunc(dset)},delete___:{value:constFunc(ddelete)},permitHostObjects___:{value:constFunc(function(token){if(token===weakMapPermitHostObjects){enableSwitching=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}DoubleWeakMap.prototype=OurWeakMap.prototype;module.exports=DoubleWeakMap;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}module.exports=OurWeakMap}})()},{}],33:[function(_dereq_,module,exports){"use strict";_dereq_("./shim-array");var WeakMap=_dereq_("weak-map");var changeObserversByObject=new WeakMap;var willChangeObserversByObject=new WeakMap;var observerFreeList=[];var observerToFreeList=[];var dispatching=false;module.exports=ObservableMap;function ObservableMap(){throw new Error("Can't construct. ObservableMap is a mixin.")}ObservableMap.prototype.observeMapChange=function(handler,name,note,capture){this.makeMapChangesObservable();var observers=this.getMapChangeObservers(capture);var observer;if(observerFreeList.length){observer=observerFreeList.pop()}else{observer=new MapChangeObserver}observer.object=this;observer.name=name;observer.capture=capture;observer.observers=observers;observer.handler=handler;observer.note=note;var stringName=""+name;var propertyName=stringName.slice(0,1).toUpperCase()+stringName.slice(1);if(!capture){var methodName="handle"+propertyName+"MapChange";if(handler[methodName]){observer.handlerMethodName=methodName}else if(handler.handleMapChange){observer.handlerMethodName="handleMapChange"}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch map changes to "+handler)}}else{var methodName="handle"+propertyName+"MapWillChange";if(handler[methodName]){observer.handlerMethodName=methodName}else if(handler.handleMapWillChange){observer.handlerMethodName="handleMapWillChange"}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch map changes to "+handler)}}observers.push(observer);return observer};ObservableMap.prototype.observeMapWillChange=function(handler,name,note){return this.observeMapChange(handler,name,note,true)};ObservableMap.prototype.dispatchMapChange=function(type,key,plus,minus,capture){if(plus===minus){return}if(!dispatching){return this.startMapChangeDispatchContext(type,key,plus,minus,capture)}var observers=this.getMapChangeObservers(capture);for(var index=0;index<observers.length;index++){var observer=observers[index];observer.dispatch(type,key,plus,minus)}};ObservableMap.prototype.dispatchMapWillChange=function(type,key,plus,minus){return this.dispatchMapChange(type,key,plus,minus,true)};ObservableMap.prototype.startMapChangeDispatchContext=function(type,key,plus,minus,capture){dispatching=true;try{this.dispatchMapChange(type,key,plus,minus,capture)}catch(error){if(typeof error==="object"&&typeof error.message==="string"){error.message="Map change dispatch possibly corrupted by error: "+error.message;throw error}else{throw new Error("Map change dispatch possibly corrupted by error: "+error)}}finally{dispatching=false;if(observerToFreeList.length){observerFreeList.push.apply(observerFreeList,observerToFreeList);observerToFreeList.clear()}}};ObservableMap.prototype.makeMapChangesObservable=function(){this.dispatchesMapChanges=true};ObservableMap.prototype.getMapChangeObservers=function(capture){var byObject=capture?willChangeObserversByObject:changeObserversByObject;if(!byObject.has(this)){byObject.set(this,[])}return byObject.get(this)};ObservableMap.prototype.getMapWillChangeObservers=function(){return this.getMapChangeObservers(true)};function MapChangeObserver(){this.init()}MapChangeObserver.prototype.init=function(){this.object=null;this.name=null;this.observers=null;this.handler=null;this.handlerMethodName=null;this.childObserver=null;this.note=null;this.capture=null};MapChangeObserver.prototype.cancel=function(){var observers=this.observers;var index=observers.indexOf(this);if(index<0){throw new Error("Can't cancel observer for "+JSON.stringify(this.name)+" map changes"+" because it has already been canceled")}var childObserver=this.childObserver;observers.splice(index,1);this.init();if(dispatching){observerToFreeList.push(this)}else{observerFreeList.push(this)}if(childObserver){childObserver.cancel()}};MapChangeObserver.prototype.dispatch=function(type,key,plus,minus){var handler=this.handler;if(!handler){return}var childObserver=this.childObserver;this.childObserver=null;if(childObserver){childObserver.cancel()}var handlerMethodName=this.handlerMethodName;if(handlerMethodName&&typeof handler[handlerMethodName]==="function"){childObserver=handler[handlerMethodName](plus,minus,key,type,this.object)}else if(handler.call){childObserver=handler.call(void 0,plus,minus,key,type,this.object)}else{throw new Error("Can't dispatch map change for "+JSON.stringify(this.name)+" to "+handler+" because there is no handler method")}this.childObserver=childObserver;return this}},{"./shim-array":36,"weak-map":32}],34:[function(_dereq_,module,exports){"use strict";_dereq_("./shim-array");_dereq_("./shim-object");var WeakMap=_dereq_("weak-map");var observersByObject=new WeakMap;var observerFreeList=[];var observerToFreeList=[];var wrappedObjectDescriptors=new WeakMap;var dispatching=false;module.exports=ObservableObject;function ObservableObject(){throw new Error("Can't construct. ObservableObject is a mixin.")}ObservableObject.prototype.observePropertyChange=function(name,handler,note,capture){return observePropertyChange(this,name,handler,note,capture)};ObservableObject.prototype.observePropertyWillChange=function(name,handler,note){return observePropertyWillChange(this,name,handler,note)};ObservableObject.prototype.dispatchPropertyChange=function(name,plus,minus,capture){return dispatchPropertyChange(this,name,plus,minus,capture)};ObservableObject.prototype.dispatchPropertyWillChange=function(name,plus,minus){return dispatchPropertyWillChange(this,name,plus,minus)};ObservableObject.prototype.getPropertyChangeObservers=function(name,capture){return getPropertyChangeObservers(this,name,capture)};ObservableObject.prototype.getPropertyWillChangeObservers=function(name){return getPropertyWillChangeObservers(this,name)};ObservableObject.prototype.makePropertyObservable=function(name){return makePropertyObservable(this,name)};ObservableObject.prototype.preventPropertyObserver=function(name){return preventPropertyObserver(this,name)
};ObservableObject.prototype.PropertyChangeObserver=PropertyChangeObserver;ObservableObject.observePropertyChange=function(object,name,handler,note,capture){if(object.observePropertyChange){return object.observePropertyChange(name,handler,note,capture)}else{return observePropertyChange(object,name,handler,note,capture)}};ObservableObject.observePropertyWillChange=function(object,name,handler,note){if(object.observePropertyWillChange){return object.observePropertyWillChange(name,handler,note)}else{return observePropertyWillChange(object,name,handler,note)}};ObservableObject.dispatchPropertyChange=function(object,name,plus,minus,capture){if(object.dispatchPropertyChange){return object.dispatchPropertyChange(name,plus,minus,capture)}else{return dispatchPropertyChange(object,name,plus,minus,capture)}};ObservableObject.dispatchPropertyWillChange=function(object,name,plus,minus){if(object.dispatchPropertyWillChange){return object.dispatchPropertyWillChange(name,plus,minus)}else{return dispatchPropertyWillChange(object,name,plus,minus)}};ObservableObject.getPropertyChangeObservers=function(object,name,capture){if(object.getPropertyChangeObservers){return object.getPropertyChangeObservers(name,capture)}else{return getPropertyChangeObservers(object,name,capture)}};ObservableObject.getPropertyWillChangeObservers=function(object,name){if(object.getPropertyWillChangeObservers){return object.getPropertyWillChangeObservers(name)}else{return getPropertyWillChangeObservers(object,name)}};ObservableObject.makePropertyObservable=function(object,name){if(object.makePropertyObservable){return object.makePropertyObservable(name)}else{return makePropertyObservable(object,name)}};ObservableObject.preventPropertyObserver=function(object,name){if(object.preventPropertyObserver){return object.preventPropertyObserver(name)}else{return preventPropertyObserver(object,name)}};function observePropertyChange(object,name,handler,note,capture){ObservableObject.makePropertyObservable(object,name);var observers=getPropertyChangeObservers(object,name,capture);var observer;if(observerFreeList.length){observer=observerFreeList.pop()}else{observer=new PropertyChangeObserver}observer.object=object;observer.propertyName=name;observer.capture=capture;observer.observers=observers;observer.handler=handler;observer.note=note;observer.value=object[name];var stringName=""+name;var propertyName=stringName.slice(0,1).toUpperCase()+stringName.slice(1);if(!capture){var specificChangeMethodName="handle"+propertyName+"PropertyChange";var genericChangeMethodName="handlePropertyChange";if(handler[specificChangeMethodName]){observer.handlerMethodName=specificChangeMethodName}else if(handler[genericChangeMethodName]){observer.handlerMethodName=genericChangeMethodName}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch "+JSON.stringify(name)+" property changes on "+object)}}else{var specificWillChangeMethodName="handle"+propertyName+"PropertyWillChange";var genericWillChangeMethodName="handlePropertyWillChange";if(handler[specificWillChangeMethodName]){observer.handlerMethodName=specificWillChangeMethodName}else if(handler[genericWillChangeMethodName]){observer.handlerMethodName=genericWillChangeMethodName}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch "+JSON.stringify(name)+" property changes on "+object)}}observers.push(observer);return observer}function observePropertyWillChange(object,name,handler,note){return observePropertyChange(object,name,handler,note,true)}function dispatchPropertyChange(object,name,plus,minus,capture){if(!dispatching){return startPropertyChangeDispatchContext(object,name,plus,minus,capture)}var observers=getPropertyChangeObservers(object,name,capture).slice();for(var index=0;index<observers.length;index++){var observer=observers[index];observer.dispatch(plus,minus)}}function dispatchPropertyWillChange(object,name,plus,minus){dispatchPropertyChange(object,name,plus,minus,true)}function startPropertyChangeDispatchContext(object,name,plus,minus,capture){dispatching=true;try{dispatchPropertyChange(object,name,plus,minus,capture)}catch(error){if(typeof error==="object"&&typeof error.message==="string"){error.message="Property change dispatch possibly corrupted by error: "+error.message;throw error}else{throw new Error("Property change dispatch possibly corrupted by error: "+error)}}finally{dispatching=false;if(observerToFreeList.length){observerFreeList.push.apply(observerFreeList,observerToFreeList);observerToFreeList.clear()}}}function getPropertyChangeObservers(object,name,capture){if(!observersByObject.has(object)){observersByObject.set(object,Object.create(null))}var observersByKey=observersByObject.get(object);var phase=capture?"WillChange":"Change";var key=name+phase;if(!Object.owns(observersByKey,key)){observersByKey[key]=[]}return observersByKey[key]}function getPropertyWillChangeObservers(object,name){return getPropertyChangeObservers(object,name,true)}function PropertyChangeObserver(){this.init()}PropertyChangeObserver.prototype.init=function(){this.object=null;this.propertyName=null;this.observers=null;this.handler=null;this.handlerMethodName=null;this.childObserver=null;this.note=null;this.capture=null;this.value=null};PropertyChangeObserver.prototype.cancel=function(){var observers=this.observers;var index=observers.indexOf(this);if(index<0){throw new Error("Can't cancel observer for "+JSON.stringify(this.propertyName)+" on "+this.object+" because it has already been canceled")}var childObserver=this.childObserver;observers.splice(index,1);this.init();if(dispatching){observerToFreeList.push(this)}else{observerFreeList.push(this)}if(childObserver){childObserver.cancel()}};PropertyChangeObserver.prototype.dispatch=function(plus,minus){var handler=this.handler;if(!handler){return}if(minus===void 0){minus=this.value}this.value=plus;var childObserver=this.childObserver;this.childObserver=null;if(childObserver){childObserver.cancel()}var handlerMethodName=this.handlerMethodName;if(handlerMethodName&&typeof handler[handlerMethodName]==="function"){childObserver=handler[handlerMethodName](plus,minus,this.propertyName,this.object)}else if(handler.call){childObserver=handler.call(void 0,plus,minus,this.propertyName,this.object)}else{throw new Error("Can't dispatch "+JSON.stringify(handlerMethodName)+" property change on "+object+" because there is no handler method")}this.childObserver=childObserver;return this};function makePropertyObservable(object,name){var wrappedDescriptor=wrapPropertyDescriptor(object,name);if(!wrappedDescriptor){return}var thunk;if("value"in wrappedDescriptor){thunk=makeValuePropertyThunk(name,wrappedDescriptor)}else{thunk=makeGetSetPropertyThunk(name,wrappedDescriptor)}Object.defineProperty(object,name,thunk)}function preventPropertyObserver(object,name){var wrappedDescriptor=wrapPropertyDescriptor(object,name);Object.defineProperty(object,name,wrappedDescriptor)}function wrapPropertyDescriptor(object,name){if(Array.isArray(object)){return}if(!Object.isExtensible(object,name)){return}var wrappedDescriptor=getPropertyDescriptor(object,name);var wrappedPrototype=wrappedDescriptor.prototype;var existingWrappedDescriptors=wrappedObjectDescriptors.get(wrappedPrototype);if(existingWrappedDescriptors&&Object.owns(existingWrappedDescriptors,name)){return}if(!wrappedObjectDescriptors.has(object)){wrappedPropertyDescriptors={};wrappedObjectDescriptors.set(object,wrappedPropertyDescriptors)}var wrappedPropertyDescriptors=wrappedObjectDescriptors.get(object);if(Object.owns(wrappedPropertyDescriptors,name)){return}if(!wrappedDescriptor.configurable){return}wrappedPropertyDescriptors[name]=wrappedDescriptor;if(!wrappedDescriptor.writable&&!wrappedDescriptor.set){return}if(wrappedDescriptor.get&&!wrappedDescriptor.set){return}return wrappedDescriptor}function getPropertyDescriptor(object,name){var descriptor;var prototype=object;do{descriptor=Object.getOwnPropertyDescriptor(prototype,name);if(descriptor){break}prototype=Object.getPrototypeOf(prototype)}while(prototype);if(descriptor){descriptor.prototype=prototype;return descriptor}else{return{prototype:object,value:undefined,enumerable:false,writable:true,configurable:true}}}function makeValuePropertyThunk(name,wrappedDescriptor){return{get:function(){if(this.__state__===void 0||this.__state__.__this__!==this){initState(this);this.__state__[name]=wrappedDescriptor.value}var state=this.__state__;return state[name]},set:function(plus){if(this.__state__===void 0||this.__state__.__this__!==this){initState(this);this.__state__[name]=this[name]}var state=this.__state__;if(plus===state[name]){return plus}dispatchPropertyWillChange(this,name,plus);wrappedDescriptor.value=plus;state[name]=plus;dispatchPropertyChange(this,name,plus);return plus},enumerable:wrappedDescriptor.enumerable,configurable:true}}function makeGetSetPropertyThunk(name,wrappedDescriptor){return{get:function(){if(wrappedDescriptor.get){return wrappedDescriptor.get.apply(this,arguments)}},set:function(plus){if(this.__state__===void 0||this.__state__.__this__!==this){initState(this);this.__state__[name]=this[name]}var state=this.__state__;if(state[name]===plus){return plus}dispatchPropertyWillChange(this,name,plus);if(wrappedDescriptor.set){wrappedDescriptor.set.apply(this,arguments);state[name]=plus}if(wrappedDescriptor.get){plus=wrappedDescriptor.get.apply(this,arguments)}dispatchPropertyChange(this,name,plus);return plus},enumerable:wrappedDescriptor.enumerable,configurable:true}}function initState(object){Object.defineProperty(object,"__state__",{value:{__this__:object},writable:true,enumerable:false,configurable:true})}},{"./shim-array":36,"./shim-object":38,"weak-map":32}],35:[function(_dereq_,module,exports){"use strict";var WeakMap=_dereq_("weak-map");var changeObserversByObject=new WeakMap;var willChangeObserversByObject=new WeakMap;var observerFreeList=[];var observerToFreeList=[];var dispatching=false;module.exports=ObservableRange;function ObservableRange(){throw new Error("Can't construct. ObservableRange is a mixin.")}ObservableRange.prototype.observeRangeChange=function(handler,name,note,capture){this.makeRangeChangesObservable();var observers=this.getRangeChangeObservers(capture);var observer;if(observerFreeList.length){observer=observerFreeList.pop()}else{observer=new RangeChangeObserver}observer.object=this;observer.name=name;observer.capture=capture;observer.observers=observers;observer.handler=handler;observer.note=note;var stringName=""+name;var propertyName=stringName.slice(0,1).toUpperCase()+stringName.slice(1);if(!capture){var methodName="handle"+propertyName+"RangeChange";if(handler[methodName]){observer.handlerMethodName=methodName}else if(handler.handleRangeChange){observer.handlerMethodName="handleRangeChange"}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch "+JSON.stringify(name)+" map changes")}}else{var methodName="handle"+propertyName+"RangeWillChange";if(handler[methodName]){observer.handlerMethodName=methodName}else if(handler.handleRangeWillChange){observer.handlerMethodName="handleRangeWillChange"}else if(handler.call){observer.handlerMethodName=null}else{throw new Error("Can't arrange to dispatch "+JSON.stringify(name)+" map changes")}}observers.push(observer);return observer};ObservableRange.prototype.observeRangeWillChange=function(handler,name,note){return this.observeRangeChange(handler,name,note,true)};ObservableRange.prototype.dispatchRangeChange=function(plus,minus,index,capture){if(!dispatching){return this.startRangeChangeDispatchContext(plus,minus,index,capture)}var observers=this.getRangeChangeObservers(capture);for(var observerIndex=0;observerIndex<observers.length;observerIndex++){var observer=observers[observerIndex];observer.dispatch(plus.slice(),minus.slice(),index)}};ObservableRange.prototype.dispatchRangeWillChange=function(plus,minus,index){return this.dispatchRangeChange(plus,minus,index,true)};ObservableRange.prototype.startRangeChangeDispatchContext=function(plus,minus,index,capture){dispatching=true;try{this.dispatchRangeChange(plus,minus,index,capture)}catch(error){if(typeof error==="object"&&typeof error.message==="string"){error.message="Range change dispatch possibly corrupted by error: "+error.message;throw error}else{throw new Error("Range change dispatch possibly corrupted by error: "+error)}}finally{dispatching=false;if(observerToFreeList.length){observerFreeList.push.apply(observerFreeList,observerToFreeList);observerToFreeList.clear()}}};ObservableRange.prototype.makeRangeChangesObservable=function(){this.dispatchesRangeChanges=true};ObservableRange.prototype.getRangeChangeObservers=function(capture){var byObject=capture?willChangeObserversByObject:changeObserversByObject;if(!byObject.has(this)){byObject.set(this,[])}return byObject.get(this)};ObservableRange.prototype.getRangeWillChangeObservers=function(){return this.getRangeChangeObservers(true)};function RangeChangeObserver(){this.init()}RangeChangeObserver.prototype.init=function(){this.object=null;this.name=null;this.observers=null;this.handler=null;this.handlerMethodName=null;this.childObserver=null;this.note=null;this.capture=null};RangeChangeObserver.prototype.cancel=function(){var observers=this.observers;var index=observers.indexOf(this);if(index<0){throw new Error("Can't cancel observer for "+JSON.stringify(this.name)+" range changes"+" because it has already been canceled")}var childObserver=this.childObserver;observers.splice(index,1);this.init();if(dispatching){observerToFreeList.push(this)}else{observerFreeList.push(this)}if(childObserver){childObserver.cancel()}};RangeChangeObserver.prototype.dispatch=function(plus,minus,index){var handler=this.handler;if(!handler){return}var childObserver=this.childObserver;this.childObserver=null;if(childObserver){childObserver.cancel()}var handlerMethodName=this.handlerMethodName;if(handlerMethodName&&typeof handler[handlerMethodName]==="function"){childObserver=handler[handlerMethodName](plus,minus,index,this.object)}else if(handler.call){childObserver=handler.call(void 0,plus,minus,index,this.object)}else{throw new Error("Can't dispatch range change to "+handler)}this.childObserver=childObserver;return this}},{"weak-map":32}],36:[function(_dereq_,module,exports){"use strict";var Function=_dereq_("./shim-function");var GenericCollection=_dereq_("./generic-collection");var GenericOrder=_dereq_("./generic-order");var Iterator=_dereq_("./iterator");var WeakMap=_dereq_("weak-map");module.exports=Array;var array_splice=Array.prototype.splice;var array_slice=Array.prototype.slice;Array.empty=[];if(Object.freeze){Object.freeze(Array.empty)}Array.from=function(values){var array=[];array.addEach(values);return array};Array.unzip=function(table){var transpose=[];var length=Infinity;for(var i=0;i<table.length;i++){var row=table[i];table[i]=row.toArray();if(row.length<length){length=row.length}}for(var i=0;i<table.length;i++){var row=table[i];for(var j=0;j<row.length;j++){if(j<length&&j in row){transpose[j]=transpose[j]||[];transpose[j][i]=row[j]}}}return transpose};function define(key,value){Object.defineProperty(Array.prototype,key,{value:value,writable:true,configurable:true,enumerable:false})}define("addEach",GenericCollection.prototype.addEach);define("deleteEach",GenericCollection.prototype.deleteEach);define("toArray",GenericCollection.prototype.toArray);define("toObject",GenericCollection.prototype.toObject);define("min",GenericCollection.prototype.min);define("max",GenericCollection.prototype.max);define("sum",GenericCollection.prototype.sum);define("average",GenericCollection.prototype.average);define("only",GenericCollection.prototype.only);define("flatten",GenericCollection.prototype.flatten);define("zip",GenericCollection.prototype.zip);define("enumerate",GenericCollection.prototype.enumerate);define("group",GenericCollection.prototype.group);define("sorted",GenericCollection.prototype.sorted);define("reversed",GenericCollection.prototype.reversed);define("constructClone",function(values){var clone=new this.constructor;clone.addEach(values);return clone});define("has",function(value,equals){return this.findValue(value,equals)!==-1});define("get",function(index,defaultValue){if(+index!==index)throw new Error("Indicies must be numbers");if(!index in this){return defaultValue}else{return this[index]}});define("set",function(index,value){if(index<this.length){this.splice(index,1,value)}else{this.swap(index,1,[value])}return this});define("add",function(value){this.push(value);return true});define("delete",function(value,equals){var index=this.findValue(value,equals);if(index!==-1){this.splice(index,1);return true}return false});define("findValue",function(value,equals){equals=equals||this.contentEquals||Object.equals;for(var index=0;index<this.length;index++){if(index in this&&equals(this[index],value)){return index}}return-1});define("findLastValue",function(value,equals){equals=equals||this.contentEquals||Object.equals;var index=this.length;do{index--;if(index in this&&equals(this[index],value)){return index}}while(index>0);return-1});define("swap",function(start,minusLength,plus){if(plus){if(!Array.isArray(plus)){plus=array_slice.call(plus)}}else{plus=Array.empty}if(start<0){start=this.length+start}else if(start>this.length){this.length=start}if(start+minusLength>this.length){minusLength=this.length-start}else if(minusLength<0){minusLength=0}var diff=plus.length-minusLength;var oldLength=this.length;var newLength=this.length+diff;if(diff>0){for(var index=oldLength-1;index>=start+minusLength;index--){var offset=index+diff;if(index in this){this[offset]=this[index]}else{this[offset]=void 0;delete this[offset]}}}for(var index=0;index<plus.length;index++){if(index in plus){this[start+index]=plus[index]}else{this[start+index]=void 0;delete this[start+index]}}if(diff<0){for(var index=start+plus.length;index<oldLength-diff;index++){var offset=index-diff;if(offset in this){this[index]=this[offset]}else{this[index]=void 0;delete this[index]}}}this.length=newLength});define("peek",function(){return this[0]});define("poke",function(value){if(this.length>0){this[0]=value}});define("peekBack",function(){if(this.length>0){return this[this.length-1]}});define("pokeBack",function(value){if(this.length>0){this[this.length-1]=value}});define("one",function(){for(var i in this){if(Object.owns(this,i)){return this[i]}}});define("clear",function(){this.length=0;return this});define("compare",function(that,compare){compare=compare||Object.compare;var i;var length;var lhs;var rhs;var relative;if(this===that){return 0}if(!that||!Array.isArray(that)){return GenericOrder.prototype.compare.call(this,that,compare)}length=Math.min(this.length,that.length);for(i=0;i<length;i++){if(i in this){if(!(i in that)){return-1}else{lhs=this[i];rhs=that[i];relative=compare(lhs,rhs);if(relative){return relative}}}else if(i in that){return 1}}return this.length-that.length});define("equals",function(that,equals,memo){equals=equals||Object.equals;var i=0;var length=this.length;var left;var right;if(this===that){return true}if(!that||!Array.isArray(that)){return GenericOrder.prototype.equals.call(this,that)}if(length!==that.length){return false}else{for(;i<length;++i){if(i in this){if(!(i in that)){return false}left=this[i];right=that[i];if(!equals(left,right,equals,memo)){return false}}else{if(i in that){return false}}}}return true});define("clone",function(depth,memo){if(depth===undefined){depth=Infinity}else if(depth===0){return this}memo=memo||new WeakMap;var clone=[];for(var i in this){if(Object.owns(this,i)){clone[i]=Object.clone(this[i],depth-1,memo)}}return clone});define("iterate",function(start,stop,step){return new Iterator(this,start,stop,step)})},{"./generic-collection":26,"./generic-order":28,"./iterator":30,"./shim-function":37,"weak-map":32}],37:[function(_dereq_,module,exports){module.exports=Function;Function.noop=function(){};Function.identity=function(value){return value};Function.by=function(by,compare){compare=compare||Object.compare;by=by||Function.identity;var compareBy=function(a,b){return compare(by(a),by(b))};compareBy.compare=compare;compareBy.by=by;return compareBy};Function.get=function(key){return function(object){return Object.get(object,key)}}},{}],38:[function(_dereq_,module,exports){"use strict";var WeakMap=_dereq_("weak-map");module.exports=Object;Object.empty=Object.freeze(Object.create(null));Object.isObject=function(object){return Object(object)===object};Object.getValueOf=function(value){if(value&&typeof value.valueOf==="function"){value=value.valueOf()}return value};var hashMap=new WeakMap;Object.hash=function(object){if(object&&typeof object.hash==="function"){return""+object.hash()}else if(Object.isObject(object)){if(!hashMap.has(object)){hashMap.set(object,Math.random().toString(36).slice(2))}return hashMap.get(object)}else{return""+object}};var owns=Object.prototype.hasOwnProperty;Object.owns=function(object,key){return owns.call(object,key)};Object.has=function(object,key){if(typeof object!=="object"){throw new Error("Object.has can't accept non-object: "+typeof object)}if(object&&typeof object.has==="function"){return object.has(key)}else if(typeof key==="string"){return key in object&&object[key]!==Object.prototype[key]}else{throw new Error("Key must be a string for Object.has on plain objects")}};Object.get=function(object,key,value){if(typeof object!=="object"){throw new Error("Object.get can't accept non-object: "+typeof object)}if(object&&typeof object.get==="function"){return object.get(key,value)}else if(Object.has(object,key)){return object[key]}else{return value}};Object.set=function(object,key,value){if(object&&typeof object.set==="function"){object.set(key,value)}else{object[key]=value}};Object.addEach=function(target,source){if(!source){}else if(typeof source.forEach==="function"&&!source.hasOwnProperty("forEach")){if(typeof source.keys==="function"){source.forEach(function(value,key){target[key]=value})}else{source.forEach(function(pair){target[pair[0]]=pair[1]})}}else{Object.keys(source).forEach(function(key){target[key]=source[key]})}return target};Object.forEach=function(object,callback,thisp){Object.keys(object).forEach(function(key){callback.call(thisp,object[key],key,object)})};Object.map=function(object,callback,thisp){return Object.keys(object).map(function(key){return callback.call(thisp,object[key],key,object)})};Object.values=function(object){return Object.map(object,Function.identity)};Object.concat=function(){var object={};for(var i=0;i<arguments.length;i++){Object.addEach(object,arguments[i])}return object};Object.from=Object.concat;Object.is=function(x,y){if(x===y){return x!==0||1/x===1/y}return x!==x&&y!==y};Object.equals=function(a,b,equals,memo){equals=equals||Object.equals;a=Object.getValueOf(a);b=Object.getValueOf(b);if(a===b)return true;if(Object.isObject(a)){memo=memo||new WeakMap;if(memo.has(a)){return true}memo.set(a,true)}if(Object.isObject(a)&&typeof a.equals==="function"){return a.equals(b,equals,memo)}if(Object.isObject(b)&&typeof b.equals==="function"){return b.equals(a,equals,memo)}if(Object.isObject(a)&&Object.isObject(b)){if(Object.getPrototypeOf(a)===Object.prototype&&Object.getPrototypeOf(b)===Object.prototype){for(var name in a){if(!equals(a[name],b[name],equals,memo)){return false}}for(var name in b){if(!(name in a)||!equals(b[name],a[name],equals,memo)){return false}}return true}}if(a!==a&&b!==b)return true;if(!a||!b)return a===b;return false};Object.compare=function(a,b){a=Object.getValueOf(a);b=Object.getValueOf(b);if(a===b)return 0;var aType=typeof a;var bType=typeof b;if(aType==="number"&&bType==="number")return a-b;if(aType==="string"&&bType==="string")return a<b?-Infinity:Infinity;if(a&&typeof a.compare==="function")return a.compare(b);if(b&&typeof b.compare==="function")return-b.compare(a);return 0};Object.clone=function(value,depth,memo){value=Object.getValueOf(value);memo=memo||new WeakMap;if(depth===undefined){depth=Infinity}else if(depth===0){return value}if(typeof value==="function"){return value}else if(Object.isObject(value)){if(!memo.has(value)){if(value&&typeof value.clone==="function"){memo.set(value,value.clone(depth,memo))}else{var prototype=Object.getPrototypeOf(value);if(prototype===null||prototype===Object.prototype){var clone=Object.create(prototype);memo.set(value,clone);for(var key in value){clone[key]=Object.clone(value[key],depth-1,memo)}}else{throw new Error("Can't clone "+value)}}}return memo.get(value)}return value};Object.clear=function(object){if(object&&typeof object.clear==="function"){object.clear()}else{var keys=Object.keys(object),i=keys.length;while(i){i--;delete object[keys[i]]}}return object}},{"weak-map":32}],39:[function(_dereq_,module,exports){if(!RegExp.escape){var special=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(string){return string.replace(special,"\\$&")}}},{}],40:[function(_dereq_,module,exports){var Array=_dereq_("./shim-array");var Object=_dereq_("./shim-object");var Function=_dereq_("./shim-function");var RegExp=_dereq_("./shim-regexp")},{"./shim-array":36,"./shim-function":37,"./shim-object":38,"./shim-regexp":39}],41:[function(_dereq_,module,exports){"use strict";module.exports=TreeLog;function TreeLog(){}TreeLog.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"};TreeLog.unicodeRound={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""};TreeLog.unicodeSharp={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""}},{}],42:[function(_dereq_,module,exports){module.exports=_dereq_("weak-map")},{"weak-map":32}],43:[function(_dereq_,module,exports){"use strict";var url=_dereq_("url");var reTrailingSlash=/\/$/;module.exports=function(signalhost,callback){var script;var baseUrl;var basePath;var scriptSrc;if(typeof signalhost=="function"){callback=signalhost;signalhost=location.origin}baseUrl=signalhost.replace(reTrailingSlash,"");basePath=url.parse(signalhost).pathname;scriptSrc=baseUrl+"/rtc.io/primus.js";script=document.querySelector('script[src="'+scriptSrc+'"]');if(script&&typeof Primus!="undefined"){return callback(null,Primus)}else if(script){script.addEventListener("load",function(){callback(null,Primus)});return}script=document.createElement("script");script.src=scriptSrc;script.onerror=callback;script.addEventListener("load",function(){if(basePath!=="/"){Primus.prototype.pathname=basePath.replace(reTrailingSlash,"")+Primus.prototype.pathname}callback(null,Primus)});document.body.appendChild(script)}},{url:10}],44:[function(_dereq_,module,exports){"use strict";var debug=_dereq_("cog/logger")("rtc-signaller");var jsonparse=_dereq_("cog/jsonparse");module.exports=function(signaller){var handlers=_dereq_("./handlers")(signaller);function sendEvent(parts,srcState,data){var evtName=parts[0].slice(1);var args=parts.slice(2).map(jsonparse);signaller.emit.apply(signaller,[evtName].concat(args).concat([srcState,data]))}return function(originalData){var id=signaller.id;var data=originalData;var isMatch=true;var parts;var handler;var srcData;var srcState;var isDirectMessage=false;debug("signaller "+signaller.id+" received data: "+originalData);if(data.slice(0,3)==="/to"){isMatch=data.slice(4,id.length+4)===id;if(isMatch){parts=data.slice(5+id.length).split("|").map(jsonparse);isDirectMessage=true;parts=parts.map(jsonparse)}}if(!isMatch){return}parts=parts||data.split("|").map(jsonparse);if(typeof parts[0]=="string"&&parts[0].charAt(0)==="/"){handler=handlers[parts[0].slice(1)];srcData=parts[1];if(srcData&&srcData.id===signaller.id){return console.warn("got data from ourself, discarding")}srcState=signaller.peers.get(srcData&&srcData.id)||srcData;if(typeof handler=="function"){handler(parts.slice(2),parts[0].slice(1),srcData,srcState,isDirectMessage)}else{sendEvent(parts,srcState,originalData)}}}}},{"./handlers":20,"cog/jsonparse":15,"cog/logger":16}],45:[function(_dereq_,module,exports){"use strict";var async=_dereq_("async");var monitor=_dereq_("./monitor");var detect=_dereq_("./detect");var CLOSED_STATES=["closed","failed"];function couple(pc,targetId,signaller,opts){var debug=_dereq_("cog/logger")("couple");var mon=monitor(pc);var queuedCandidates=[];var sdpFilter=(opts||{}).sdpfilter;var reactive=(opts||{}).reactive;var offerTimeout;var disconnectTimeout=(opts||{}).disconnectTimeout||1e4;var disconnectTimer;if(typeof signaller.isMaster!="function"){throw new Error("rtc-signaller instance >= 0.14.0 required")}var isMaster=signaller.isMaster(targetId);var createOffer=prepNegotiate("createOffer",isMaster,[checkStable,checkNotConnecting]);var createAnswer=prepNegotiate("createAnswer",true,[checkNotConnecting]);var q=async.queue(function(task,cb){if(typeof task.op!="function"){return cb()}task.op(task,cb)},1);var RTCSessionDescription=(opts||{}).RTCSessionDescription||detect("RTCSessionDescription");var RTCIceCandidate=(opts||{}).RTCIceCandidate||detect("RTCIceCandidate");function abort(stage,sdp,cb){return function(err){console.error("rtc/couple error ("+stage+"): ",err);if(typeof cb=="function"){cb(err)}}}function applyCandidatesWhenStable(){if(pc.signalingState=="stable"&&pc.remoteDescription){debug("signaling state = stable, applying queued candidates");mon.removeListener("change",applyCandidatesWhenStable);queuedCandidates.splice(0).forEach(function(data){debug("applying queued candidate",data);try{pc.addIceCandidate(new RTCIceCandidate(data))}catch(e){debug("invalidate candidate specified: ",data)}})}}function checkNotConnecting(negotiate){if(pc.iceConnectionState!="checking"){return true}debug("connection state is checking, will wait to create a new offer");mon.once("connected",function(){q.push({op:negotiate})});return false}function checkStable(negotiate){if(pc.signalingState==="stable"){return true}debug("cannot create offer, signaling state != stable, will retry");mon.on("change",function waitForStable(){if(pc.signalingState==="stable"){q.push({op:negotiate})}mon.removeListener("change",waitForStable)});return false}function prepNegotiate(methodName,allowed,preflightChecks){preflightChecks=[].concat(preflightChecks||[]);return function negotiate(task,cb){var checksOK=true;if(!allowed){signaller.to(targetId).send("/negotiate");return cb()}preflightChecks.forEach(function(check){checksOK=checksOK&&check(negotiate)});if(!checksOK){debug("preflight checks did not pass, aborting "+methodName);return cb()}debug("calling "+methodName);pc[methodName](function(desc){if(typeof sdpFilter=="function"){desc.sdp=sdpFilter(desc.sdp,pc,methodName)}q.push({op:queueLocalDesc(desc)});cb()},abort(methodName,"",cb))}}function handleConnectionClose(){debug("captured pc close, iceConnectionState = "+pc.iceConnectionState);signaller.removeListener("sdp",handleSdp);signaller.removeListener("candidate",handleRemoteCandidate)}function handleDisconnect(){debug("captured pc disconnect, monitoring connection status");disconnectTimer=setTimeout(function(){pc.close()},disconnectTimeout);mon.on("change",handleDisconnectAbort)}function handleDisconnectAbort(){mon.removeListener("change",handleDisconnectAbort);debug("reset disconnect timer, state: "+pc.iceConnectionState);clearTimeout(disconnectTimer);if(CLOSED_STATES.indexOf(pc.iceConnectionState)>=0){handleConnectionClose()}else{mon.once("disconnect",handleDisconnect)}}function handleLocalCandidate(evt){if(evt.candidate){signaller.to(targetId).send("/candidate",evt.candidate)}else{debug("ice gathering state complete");signaller.to(targetId).send("/endofcandidates",{})}}function handleRemoteCandidate(data,src){if(!src||src.id!==targetId){return}if(pc.signalingState!="stable"||!pc.remoteDescription){queuedCandidates.push(data);mon.removeListener("change",applyCandidatesWhenStable);mon.on("change",applyCandidatesWhenStable);return}try{pc.addIceCandidate(new RTCIceCandidate(data))
}catch(e){debug("invalidate candidate specified: ",data)}}function handleSdp(data,src){var abortType=data.type==="offer"?"createAnswer":"createOffer";if(!src||src.id!==targetId){return}q.push({op:function(task,cb){pc.setRemoteDescription(new RTCSessionDescription(data),function(){if(data.type==="offer"){queue(createAnswer)()}cb()},abort(abortType,data.sdp,cb))}})}function queue(negotiateTask){return function(){q.push([{op:negotiateTask}])}}function queueLocalDesc(desc){return function setLocalDesc(task,cb){debug("setting local description");pc.setLocalDescription(desc,function(){signaller.to(targetId).send("/sdp",desc);cb()},function(err){debug("error setting local description",err);debug(desc.sdp);cb(err)})}}if(typeof targetId!="string"&&!(targetId instanceof String)){throw new Error("2nd argument (targetId) should be a string")}if(reactive){pc.onnegotiationneeded=function(){debug("renegotiation required, will create offer in 50ms");clearTimeout(offerTimeout);offerTimeout=setTimeout(queue(createOffer),50)}}pc.onicecandidate=handleLocalCandidate;signaller.on("sdp",handleSdp);signaller.on("candidate",handleRemoteCandidate);if(isMaster){signaller.on("negotiate",function(src){if(src.id===targetId){debug("got negotiate request from "+targetId+", creating offer");q.push({op:createOffer})}})}mon.once("closed",handleConnectionClose);mon.once("disconnected",handleDisconnect);mon.createOffer=queue(createOffer);return mon}module.exports=couple},{"./detect":46,"./monitor":49,async:12,"cog/logger":16}],46:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("rtc-core/detect")},{"rtc-core/detect":18}],47:[function(_dereq_,module,exports){"use strict";var debug=_dereq_("cog/logger")("generators");var detect=_dereq_("./detect");var defaults=_dereq_("cog/defaults");var mappings={create:{dtls:function(c){if(!detect.moz){c.optional=(c.optional||[]).concat({DtlsSrtpKeyAgreement:true})}}}};var knownFlags=["video","audio","data"];exports.config=function(config){return defaults(config,{iceServers:[]})};exports.connectionConstraints=function(flags,constraints){var generated={};var m=mappings.create;var out;Object.keys(flags||{}).forEach(function(key){if(m[key]){m[key](generated)}});out=defaults({},constraints,generated);debug("generated connection constraints: ",out);return out};exports.parseFlags=function(options){var opts=options||{};opts.video=opts.video||typeof opts.video=="undefined";opts.audio=opts.audio||typeof opts.audio=="undefined";return Object.keys(opts||{}).filter(function(flag){return opts[flag]}).map(function(flag){return flag.toLowerCase()}).filter(function(flag){return knownFlags.indexOf(flag)>=0})}},{"./detect":46,"cog/defaults":13,"cog/logger":16}],48:[function(_dereq_,module,exports){"use strict";var gen=_dereq_("./generators");var detect=exports.detect=_dereq_("./detect");exports.logger=_dereq_("cog/logger");var RTCPeerConnection=exports.RTCPeerConnection=detect("RTCPeerConnection");exports.couple=_dereq_("./couple");exports.createConnection=function(opts,constraints){return new((opts||{}).RTCPeerConnection||RTCPeerConnection)(gen.config(opts),gen.connectionConstraints(opts,constraints))}},{"./couple":45,"./detect":46,"./generators":47,"cog/logger":16}],49:[function(_dereq_,module,exports){(function(process){"use strict";var debug=_dereq_("cog/logger")("monitor");var EventEmitter=_dereq_("events").EventEmitter;var comboStates={active:["connected","stable"]};var monitor=module.exports=function(pc){var mon=new EventEmitter;var currentState=getState(pc);var isActive=mon.active=currentState[0]==="connected";var lastConnectionState=pc&&pc.iceConnectionState;function checkState(){var newState=getState(pc);var testState=[].concat(newState);var isChange=false;debug("captured state change: ",newState);while(!isChange&&testState.length>0){isChange=isChange||testState.shift()!==currentState.shift()}mon.active=newState[0]==="connected";if(isChange){mon.emit("change",pc)}if(lastConnectionState!=newState[0]){debug("iceConnectionState change: "+lastConnectionState+" --> "+newState[0]);mon.emit(newState[0],pc);lastConnectionState=newState[0]}currentState=[].concat(newState)}if(isActive){process.nextTick(mon.emit.bind(mon,"connected",pc))}pc.onsignalingstatechange=checkState;pc.oniceconnectionstatechange=checkState;pc.onclose=checkState;mon.stop=function(){pc.onsignalingstatechange=null;pc.oniceconnectionstatechange=null;pc.onclose=null};return mon};var getState=monitor.getState=function(pc){return pc?[pc.iceConnectionState,pc.signalingState,pc.iceGatheringState]:[]};monitor.isActive=function(pc){var isStable=pc&&pc.signalingState==="stable";return isStable&&getState(pc)===W3C_STATES.ACTIVE}}).call(this,_dereq_("/home/doehlman/.bashinate/install/node/0.10.26/lib/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/home/doehlman/.bashinate/install/node/0.10.26/lib/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,"cog/logger":16,events:4}],50:[function(_dereq_,module,exports){(function(global){var rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function whatwgRNG(){crypto.getRandomValues(_rnds8);return _rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var i=0,r;i<16;i++){if((i&3)===0)r=Math.random()*4294967296;_rnds[i]=r>>>((i&3)<<3)&255}return _rnds}}module.exports=rng}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],51:[function(_dereq_,module,exports){(function(Buffer){var _rng=_dereq_("./rng");var BufferClass=typeof Buffer=="function"?Buffer:Array;var _byteToHex=[];var _hexToByte={};for(var i=0;i<256;i++){_byteToHex[i]=(i+256).toString(16).substr(1);_hexToByte[_byteToHex[i]]=i}function parse(s,buf,offset){var i=buf&&offset||0,ii=0;buf=buf||[];s.toLowerCase().replace(/[0-9a-f]{2}/g,function(oct){if(ii<16){buf[i+ii++]=_hexToByte[oct]}});while(ii<16){buf[i+ii++]=0}return buf}function unparse(buf,offset){var i=offset||0,bth=_byteToHex;return bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]}var _seedBytes=_rng();var _nodeId=[_seedBytes[0]|1,_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]];var _clockseq=(_seedBytes[6]<<8|_seedBytes[7])&16383;var _lastMSecs=0,_lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||[];options=options||{};var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;var msecs=options.msecs!==undefined?options.msecs:(new Date).getTime();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;var node=options.node||_nodeId;for(var n=0;n<6;n++){b[i+n]=node[n]}return buf?buf:unparse(b)}function v4(options,buf,offset){var i=buf&&offset||0;if(typeof options=="string"){buf=options=="binary"?new BufferClass(16):null;options=null}options=options||{};var rnds=options.random||(options.rng||_rng)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){for(var ii=0;ii<16;ii++){buf[i+ii]=rnds[ii]}}return buf||unparse(rnds)}var uuid=v4;uuid.v1=v1;uuid.v4=v4;uuid.parse=parse;uuid.unparse=unparse;uuid.BufferClass=BufferClass;module.exports=uuid}).call(this,_dereq_("buffer").Buffer)},{"./rng":50,buffer:1}]},{},[11])(11)});